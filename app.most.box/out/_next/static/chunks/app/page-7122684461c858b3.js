(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{6396:()=>{},10097:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Z});var i=n(95155),a=n(12115),l=n(81001),s=n(46647),r=n(58887),o=n(31810);n(29439);var c=n(6874),d=n.n(c),u=n(69604),h=n(70112),x=n(39926),m=n(21220),p=n(48764),j=n(9482);function f(){let e=(0,p.k)(e=>e.wallet),t=(null==e?void 0:e.address)||j.A.ZeroAddress,n=(0,p.k)(e=>e.exit);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.Box,{className:"header",children:(0,i.jsxs)(h.Group,{wrap:"nowrap",children:[(0,i.jsx)(x.Avatar,{size:"md",radius:"sm",src:(null==e?void 0:e.address)?j.A.avatar(e.address):"/icons/pwa-512x512.png",alt:"it's me"}),(0,i.jsxs)(u.Box,{children:[(0,i.jsx)(r.Text,{size:"lg",fw:500,lineClamp:2,children:(null==e?void 0:e.username)||"Most.Box"}),(0,i.jsxs)(r.Text,{size:"sm",c:"dimmed",children:["地址: ",j.A.formatAddress(t)]})]}),(0,i.jsx)(l.ActionIcon,{ml:"auto",variant:"subtle",color:"gray",component:d(),href:{pathname:"/card",query:{uid:t}},children:(0,i.jsx)(o.I,{name:"QRCode",size:18})})]})}),(0,i.jsxs)(m.Stack,{className:"menu-list",mb:"xs",gap:0,children:[(0,i.jsx)(g,{icon:"Web3",label:"Web3",link:"/web3"}),(0,i.jsx)(g,{icon:"Earth",label:"节点",link:"/dot"})]}),(0,i.jsxs)(m.Stack,{className:"menu-list",gap:0,children:[(0,i.jsx)(g,{icon:"About",label:"关于",link:"/about"}),(0,i.jsx)(g,{icon:"Setting",label:"设置",link:"/setting"}),(0,i.jsx)(g,{icon:"Join",label:"志同道合",link:"/join"})]}),(0,i.jsx)(m.Stack,{className:"menu-list",mt:"xs",children:(0,i.jsx)(g,{icon:"Exit",label:e?"退出账户":"去登录",link:"/login",onClick:()=>{e&&n()}})})]})}function g(e){let{icon:t,label:n,link:a,onClick:l}=e;return(0,i.jsxs)(u.Box,{component:d(),href:a,className:"menu-item",onClick:l,children:[(0,i.jsxs)(h.Group,{children:[(0,i.jsx)(o.I,{name:t,size:32}),(0,i.jsx)(r.Text,{children:n})]}),(0,i.jsx)(o.I,{name:"Arrow",size:18})]})}var v=n(8141),w=n(8593),y=n(44230),k=n(26029),C=n(27361),b=n(18403),T=n(59741),D=n(89047),A=n(26903),I=n(63617),M=n(74271),S=n(54205);n(69570);var z=n(41698),P=n(86467);let F=(0,P.A)("outline","plus","Plus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]),B=(0,P.A)("outline","folder-plus","FolderPlus",[["path",{d:"M12 19h-7a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v3.5",key:"svg-0"}],["path",{d:"M16 19h6",key:"svg-1"}],["path",{d:"M19 16v6",key:"svg-2"}]]),E=(0,P.A)("outline","dots-vertical","DotsVertical",[["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M12 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}]]);var G=n(54395),N=n(6942);let H=[".note"];function R(){let e=(0,p.k)(e=>e.wallet),t=(0,p.k)(e=>e.dotCID),n=(0,p.k)(e=>e.files),s=(0,p.k)(e=>e.filesPath),o=(0,p.k)(e=>e.setItem),[c,u]=(0,a.useState)(!1),[x,f]=(0,a.useState)(!1),[g,P]=(0,a.useState)([]),[R,O]=(0,a.useState)(!1),[L,_]=(0,a.useState)(""),[V,W]=(0,a.useState)(100),[K,Q]=(0,a.useState)(!1),[U,J]=(0,a.useState)(null),[X,q]=(0,a.useState)(""),[Z,$]=(0,a.useState)(!1),[Y,ee]=(0,a.useState)(!1),[et,en]=(0,a.useState)(""),[ei,ea]=(0,a.useState)(!1),el=(0,a.useRef)(null),es=(0,a.useRef)(null),er=async e=>{try{u(!0);let t=await S.FH.post("/files/".concat(e));_(""),o("files",t.data)}catch(e){console.info(e)}finally{u(!1)}},eo=async()=>{if(!et)return void N.notifications.show({title:"提示",message:"文件夹名称不能为空",color:"red"});if(null==n?void 0:n.some(e=>"directory"===e.type&&e.name===et))return void N.notifications.show({title:"提示",message:"文件夹已存在",color:"red"});try{ea(!0);let e=s?"".concat(s,"/").concat(et):et,t=new Blob(["https://most.box"],{type:"text/plain"}),n=new FormData;n.append("file",t,"readme.txt"),n.append("path","".concat(e,"/readme.txt")),await S.FH.put("/files.upload",n),N.notifications.show({message:"文件夹创建成功",color:"green"}),await er(s),ee(!1),en("")}catch(e){console.info(e),N.notifications.show({message:e.message,color:"red"})}finally{ea(!1)}},ec=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]},ed=n?n.filter(e=>j.A.pinyin(e.name,L,0)).sort((e,t)=>"directory"===e.type&&"directory"!==t.type?-1:+("directory"!==e.type&&"directory"===t.type)):[],eu=ed.slice(0,V),eh=ed.length>V;(0,a.useEffect)(()=>{W(100)},[L]);let ex=async e=>{var t,n;if(!e||0===e.length)return;f(!0);let i=N.notifications.show({title:"上传中",message:"请稍后...",color:"blue",autoClose:!1});try{for(let n=0;n<e.length;n++){let a=e[n],l=new FormData;l.append("file",a);let r=a.webkitRelativePath,o=s?"".concat(s,"/").concat(r):r;l.append("path",o+a.name),(null==(t=(await S.FH.put("/files.upload",l)).data)?void 0:t.cid)&&N.notifications.update({id:i,title:"上传中",message:"".concat(a.name," 上传成功")})}N.notifications.update({id:i,title:"上传完成",message:"共上传 ".concat(e.length," 个文件"),color:"green",autoClose:!0}),await er(s),O(!1),P([])}catch(t){let e=(null==t||null==(n=t.response)?void 0:n.data)||"文件上传失败，请重试";e.includes("already has")&&(e="文件已存在"),N.notifications.update({id:i,title:"上传失败",message:e,color:"red",autoClose:!0})}finally{f(!1)}},em=e=>{let t=e.target.files;if(t&&t.length>0){let e=Array.from(t);1!==e.length||e[0].webkitRelativePath?(P(e.map(e=>({file:e,path:e.webkitRelativePath||e.name,size:ec(e.size)}))),O(!0)):ex(e)}e.target.value=""},ep=()=>{O(!1),P([])},ej=async e=>{try{let t=s?"".concat(s,"/").concat(e):e;await S.FH.delete("/files/".concat(t)),N.notifications.show({title:"删除成功",message:"文件 ".concat(e," 已删除"),color:"green"}),await er(s)}catch(t){console.error("删除失败:",t),N.notifications.show({title:"删除失败",message:"删除文件 ".concat(e," 失败，请重试"),color:"red"})}},ef=async()=>{if(!U||!X.trim()||X===U.name)return void Q(!1);$(!0);try{let e=s?"".concat(s,"/").concat(U.name):U.name,t=s?"".concat(s,"/").concat(X.trim()):X.trim();await S.FH.put("/files.rename",{oldName:"/".concat(e),newName:"/".concat(t)}),N.notifications.show({title:"重命名成功",message:'新名称 "'.concat(X.trim(),'"'),color:"green"}),await er(s),Q(!1),J(null),q("")}catch(e){console.error("重命名失败:",e),N.notifications.show({title:"重命名失败",message:'重命名文件 "'.concat(U.name,'" 失败，请重试'),color:"red"})}finally{$(!1)}},eg=e=>{let t=s?"".concat(s,"/").concat(e):e;o("filesPath",t),er(t)};return(0,a.useEffect)(()=>{e&&!n&&er(s)},[e,n]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(m.Stack,{gap:"md",p:"md",children:[(0,i.jsx)(v.Center,{children:(0,i.jsx)(w.TextInput,{placeholder:"搜索文件名称",value:L,onChange:e=>_(e.currentTarget.value),size:"md",radius:"md",w:400,styles:{input:{textAlign:"center"}}})}),(0,i.jsxs)(h.Group,{justify:"space-between",align:"center",pos:"relative",children:[(0,i.jsx)(y.LoadingOverlay,{visible:c,overlayProps:{backgroundOpacity:0},loaderProps:{type:"dots"}}),(0,i.jsxs)(k.Badge,{variant:"light",size:"lg",children:[L?"显示 ".concat(eu.length," / ").concat(ed.length," (总共 ").concat((null==n?void 0:n.length)||0,")"):"显示 ".concat(eu.length," / ").concat((null==n?void 0:n.length)||0)," ","个文件"]}),(0,i.jsxs)(h.Group,{children:[(0,i.jsx)(C.Tooltip,{label:"刷新",children:(0,i.jsx)(l.ActionIcon,{size:"lg",onClick:()=>er(s),color:"blue",disabled:!e,children:(0,i.jsx)(z.A,{size:18})})}),(0,i.jsx)(C.Tooltip,{label:"上传文件",children:(0,i.jsx)(l.ActionIcon,{size:"lg",onClick:()=>{var e;null==(e=el.current)||e.click()},color:"green",disabled:!e||x,children:(0,i.jsx)(F,{size:18})})}),(0,i.jsx)(C.Tooltip,{label:"上传文件夹",children:(0,i.jsx)(l.ActionIcon,{size:"lg",onClick:()=>{var e;null==(e=es.current)||e.click()},color:"yellow",disabled:!e||x,children:(0,i.jsx)(B,{size:18})})})]})]}),L&&0===ed.length?(0,i.jsxs)(m.Stack,{align:"center",justify:"center",h:200,children:[(0,i.jsx)(r.Text,{size:"lg",c:"dimmed",children:"未找到文件"}),(0,i.jsx)(r.Text,{size:"sm",c:"dimmed",children:"尝试用其他关键词搜索"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.Card,{radius:"md",withBorder:!0,children:(0,i.jsxs)(h.Group,{justify:"space-between",wrap:"nowrap",gap:4,children:[(0,i.jsx)(h.Group,{flex:1,style:{cursor:s?"pointer":""},onClick:s?()=>{let e=s.split("/");e.pop();let t=e.join("/");o("filesPath",t),er(t)}:void 0,children:(0,i.jsxs)(r.Text,{fw:500,children:["\uD83D\uDCC1 ",s?"..":"根目录"]})}),(0,i.jsxs)(T.Menu,{shadow:"md",children:[(0,i.jsx)(T.Menu.Target,{children:(0,i.jsx)(l.ActionIcon,{variant:"subtle",color:"gray",children:(0,i.jsx)(E,{size:14})})}),(0,i.jsx)(T.Menu.Dropdown,{children:(0,i.jsx)(T.Menu.Item,{onClick:()=>ee(!0),leftSection:"\uD83D\uDCC1",children:"新建文件夹"})})]})]})}),(0,i.jsx)(D.Grid,{gutter:"md",children:eu.map((e,n)=>(0,i.jsx)(D.Grid.Col,{span:{base:12,xs:6,sm:4,md:3,lg:3,xl:2},children:(0,i.jsx)(b.Card,{radius:"md",withBorder:!0,children:(0,i.jsxs)(h.Group,{justify:"space-between",wrap:"nowrap",gap:4,children:[(0,i.jsx)(m.Stack,{flex:1,style:{cursor:"directory"===e.type?"pointer":""},onClick:()=>{"directory"===e.type&&eg(e.name)},children:(0,i.jsxs)(r.Text,{fw:500,lineClamp:1,children:["directory"===e.type?"\uD83D\uDCC1":"\uD83D\uDCC4"," ",e.name]})}),(0,i.jsxs)(T.Menu,{shadow:"md",width:120,children:[(0,i.jsx)(T.Menu.Target,{children:(0,i.jsx)(l.ActionIcon,{variant:"subtle",color:"gray",children:(0,i.jsx)(E,{size:14})})}),(0,i.jsxs)(T.Menu.Dropdown,{children:[(0,i.jsx)(T.Menu.Item,{leftSection:"\uD83D\uDCD6",onClick:()=>{if("directory"===e.type)eg(e.name);else{let n="".concat(t,"/ipfs/").concat(e.cid["/"],"?filename=").concat(e.name);window.open(n,"_blank")}},children:"directory"===e.type?"打开":"查看"}),(0,i.jsx)(T.Menu.Item,{leftSection:"\uD83D\uDCE4",onClick:()=>{let n="".concat(t,"/ipfs/").concat(e.cid["/"],"?filename=").concat(e.name);navigator.share?navigator.share({title:"文件: ".concat(e.name),url:n}):navigator.clipboard.writeText(n).then(()=>{N.notifications.show({color:"green",message:"分享链接已复制到剪贴板"})})},children:"分享"}),(0,i.jsx)(T.Menu.Item,{leftSection:"✏️",onClick:()=>{J(e),q(e.name),Q(!0)},children:"重命名"}),(0,i.jsx)(T.Menu.Divider,{}),(0,i.jsx)(T.Menu.Item,{leftSection:"⬇️",component:d(),target:"_blank",href:"directory"===e.type?"".concat(t,"/ipfs/").concat(e.cid["/"],"?download=true&format=tar&filename=").concat(e.name,".tar"):"".concat(t,"/ipfs/").concat(e.cid["/"],"?download=true&filename=").concat(e.name),children:"下载"}),(0,i.jsx)(T.Menu.Item,{disabled:""===s&&"directory"===e.type&&H.includes(e.name),leftSection:"\uD83D\uDDD1️",onClick:()=>{window.confirm('确定要删除文件 "'.concat(e.name,'" 吗？'))&&ej(e.name)},children:"删除"}),e.size>0&&(0,i.jsx)(T.Menu.Label,{children:(0,i.jsx)(v.Center,{children:(0,i.jsx)(r.Text,{size:"xs",c:"dimmed",children:ec(e.size)})})})]})]})]})})},n))}),eh&&(0,i.jsx)(v.Center,{children:(0,i.jsxs)(A.Button,{variant:"light",onClick:()=>{W(e=>e+100)},size:"md",children:["继续加载 (",ed.length-V," 个剩余)"]})})]})]}),!e&&(0,i.jsx)(v.Center,{children:(0,i.jsx)(A.Button,{variant:"gradient",component:d(),href:"/login",children:"去登录"})}),(0,i.jsx)("input",{ref:el,type:"file",multiple:!0,style:{display:"none"},onChange:em}),(0,i.jsx)("input",{ref:es,type:"file",webkitdirectory:"",multiple:!0,style:{display:"none"},onChange:em}),(0,i.jsx)(I.Modal,{opened:R,onClose:ep,title:"文件预览",size:"lg",centered:!0,children:(0,i.jsxs)(m.Stack,{gap:"md",children:[(0,i.jsx)(h.Group,{justify:"space-between",children:(0,i.jsxs)(r.Text,{size:"sm",c:"dimmed",children:["共 ",g.length," 个文件，总大小: ",ec(g.reduce((e,t)=>e+t.file.size,0))]})}),(0,i.jsx)(M.ScrollArea,{h:300,children:(0,i.jsx)(m.Stack,{gap:"xs",children:g.map((e,t)=>(0,i.jsx)(b.Card,{p:"sm",withBorder:!0,children:(0,i.jsxs)(h.Group,{justify:"space-between",align:"center",wrap:"nowrap",children:[(0,i.jsxs)(h.Group,{align:"center",children:[(0,i.jsx)(r.Text,{size:"sm",children:"\uD83D\uDCC4"}),(0,i.jsxs)(m.Stack,{gap:2,children:[(0,i.jsx)(r.Text,{size:"sm",fw:500,children:e.path}),(0,i.jsx)(r.Text,{size:"xs",c:"dimmed",children:e.size})]})]}),(0,i.jsx)(l.ActionIcon,{variant:"subtle",color:"gray",onClick:()=>(e=>{let t=g.filter((t,n)=>n!==e);P(t),0===t.length&&O(!1)})(t),children:(0,i.jsx)(G.A,{})})]})},t))})}),(0,i.jsxs)(h.Group,{justify:"flex-end",gap:"sm",children:[(0,i.jsx)(A.Button,{variant:"outline",onClick:ep,disabled:x,children:"取消"}),(0,i.jsx)(A.Button,{onClick:()=>{ex(g.map(e=>e.file))},loading:x,disabled:0===g.length,children:"确认上传"})]})]})}),(0,i.jsx)(I.Modal,{opened:Y,onClose:()=>ee(!1),title:"新建文件夹",centered:!0,children:(0,i.jsxs)(m.Stack,{gap:"md",children:[(0,i.jsx)(w.TextInput,{value:et,onChange:e=>en(e.currentTarget.value),onKeyDown:e=>{"Enter"===e.key&&eo()},disabled:ei,autoFocus:!0}),(0,i.jsxs)(h.Group,{justify:"flex-end",gap:"sm",children:[(0,i.jsx)(A.Button,{onClick:()=>ee(!1),variant:"default",children:"取消"}),(0,i.jsx)(A.Button,{onClick:eo,loading:ei,children:"确认"})]})]})}),(0,i.jsx)(I.Modal,{opened:K,onClose:()=>{Q(!1),J(null),q("")},title:"新名称",centered:!0,children:(0,i.jsxs)(m.Stack,{gap:"md",children:[(0,i.jsx)(w.TextInput,{placeholder:"请输入新的文件名",value:X,onChange:e=>q(e.currentTarget.value),onKeyDown:e=>{"Enter"===e.key&&ef()},disabled:Z,autoFocus:!0}),(0,i.jsxs)(h.Group,{justify:"flex-end",gap:"sm",children:[(0,i.jsx)(A.Button,{variant:"outline",onClick:()=>{Q(!1),J(null),q("")},disabled:Z,children:"取消"}),(0,i.jsx)(A.Button,{onClick:ef,disabled:!X.trim()||X===(null==U?void 0:U.name)||Z,loading:Z,children:"确认"})]})]})})]})}n(83572),n(6396);var O=n(11681);function L(){let e=(0,p.k)(e=>e.wallet),t=(0,p.k)(e=>e.notes),n=(0,p.k)(e=>e.notesQuery),s=(0,p.k)(e=>e.setItem),[o,c]=(0,a.useState)(!1),[u,x]=(0,a.useState)(100),[f,{open:g,close:M}]=(0,O.useDisclosure)(!1),[P,B]=(0,a.useState)(""),[G,H]=(0,a.useState)(""),[R,L]=(0,a.useState)(!1),[_,{open:V,close:W}]=(0,O.useDisclosure)(!1),[K,Q]=(0,a.useState)(null),[U,J]=(0,a.useState)(""),[X,q]=(0,a.useState)(""),[Z,$]=(0,a.useState)(!1),Y=t=>{let n=new URL(window.location.href);return n.pathname="/note/",n.searchParams.set("uid",(null==e?void 0:e.address)||""),n.searchParams.set("name",t.name),n.href},ee=t?t.filter(e=>j.A.pinyin(e.name,n,0)):[],et=ee.slice(0,u),en=ee.length>u;(0,a.useEffect)(()=>{x(100)},[n]);let ei=async()=>{try{c(!0);let e=(await S.FH.post("/files/.note")).data;if(e){let t=e.map(e=>({name:e.name,cid:e.cid["/"]}));s("notes",t)}}catch(e){console.info(e)}finally{c(!1)}},ea=async()=>{let e=P.trim();if(!e)return void H("请输入笔记名称");if(null==t?void 0:t.some(t=>t.name===e))return void H("笔记名称已存在");try{var n;L(!0);let t=new FormData,i=new Blob([""],{type:"text/markdown"});t.append("file",i,"index.md"),t.append("path","/.note/".concat(e,"/index.md")),(null==(n=(await S.FH.put("/files.upload",t)).data)?void 0:n.cid)&&(N.notifications.show({color:"green",message:"笔记创建成功"}),await ei(),M(),B(""))}catch(e){N.notifications.show({color:"red",message:e instanceof Error?e.message:"创建失败，请重试"})}finally{L(!1)}},el=async()=>{if(!K)return;let e=U.trim();if(!e)return void q("请输入笔记名称");if(e===K.name)return void W();if(null==t?void 0:t.some(t=>t.name===e))return void q("笔记名称已存在");try{$(!0),await S.FH.put("/files.rename",{oldName:"/.note/".concat(K.name),newName:"/.note/".concat(e)}),N.notifications.show({color:"green",message:"重命名成功"}),await ei(),W()}catch(e){N.notifications.show({color:"red",message:e instanceof Error?e.message:"重命名失败"})}finally{$(!1)}},es=async e=>{if(confirm('确定要删除笔记"'.concat(e.name,'"吗？此操作不可撤销。')))try{await S.FH.delete("/files/.note/".concat(e.name)),N.notifications.show({color:"green",message:"删除成功"}),await ei()}catch(e){N.notifications.show({color:"red",message:e instanceof Error?e.message:"删除失败"})}},er=()=>{B(""),H(""),M()},eo=()=>{Q(null),J(""),q(""),W()};return(0,a.useEffect)(()=>{e&&!t&&ei()},[e,t]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(m.Stack,{gap:"md",p:"md",children:[(0,i.jsx)(v.Center,{children:(0,i.jsx)(w.TextInput,{placeholder:"搜索笔记名称",value:n,onChange:e=>s("notesQuery",e.currentTarget.value),size:"md",radius:"md",w:400,styles:{input:{textAlign:"center"}}})}),(0,i.jsxs)(h.Group,{justify:"space-between",align:"center",pos:"relative",children:[(0,i.jsx)(y.LoadingOverlay,{visible:o,overlayProps:{backgroundOpacity:0},loaderProps:{type:"dots"}}),(0,i.jsxs)(k.Badge,{variant:"light",size:"lg",children:[n?"显示 ".concat(et.length," / ").concat(ee.length," (总共 ").concat((null==t?void 0:t.length)||0,")"):"显示 ".concat(et.length," / ").concat((null==t?void 0:t.length)||0)," ","个笔记"]}),(0,i.jsxs)(h.Group,{children:[(0,i.jsx)(C.Tooltip,{label:"刷新",children:(0,i.jsx)(l.ActionIcon,{size:"lg",onClick:ei,color:"blue",disabled:!e,children:(0,i.jsx)(z.A,{size:18})})}),(0,i.jsx)(C.Tooltip,{label:"新笔记",children:(0,i.jsx)(l.ActionIcon,{size:"lg",onClick:g,color:"green",disabled:!e,children:(0,i.jsx)(F,{size:18})})})]})]}),n&&0===ee.length?(0,i.jsxs)(m.Stack,{align:"center",justify:"center",h:200,children:[(0,i.jsx)(r.Text,{size:"lg",c:"dimmed",children:"未找到笔记"}),(0,i.jsx)(r.Text,{size:"sm",c:"dimmed",children:"尝试用其他关键词搜索"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(D.Grid,{gutter:"md",children:et.map(e=>(0,i.jsx)(D.Grid.Col,{span:{base:12,xs:6,sm:4,md:3,lg:3,xl:2},children:(0,i.jsx)(b.Card,{radius:"md",withBorder:!0,children:(0,i.jsxs)(h.Group,{justify:"space-between",wrap:"nowrap",gap:4,children:[(0,i.jsx)(r.Text,{flex:1,fw:500,lineClamp:1,component:d(),href:Y(e),children:e.name}),(0,i.jsxs)(T.Menu,{shadow:"md",width:120,children:[(0,i.jsx)(T.Menu.Target,{children:(0,i.jsx)(l.ActionIcon,{variant:"subtle",color:"gary",children:(0,i.jsx)(E,{size:14})})}),(0,i.jsxs)(T.Menu.Dropdown,{children:[(0,i.jsx)(T.Menu.Item,{leftSection:"\uD83D\uDCD6",onClick:()=>(e=>{let t=Y(e);window.open(t)})(e),children:"打开"}),(0,i.jsx)(T.Menu.Item,{leftSection:"\uD83D\uDCE4",onClick:()=>(e=>{let t=Y(e);navigator.share?navigator.share({title:"笔记: ".concat(e.name),url:t}):navigator.clipboard.writeText(t).then(()=>{N.notifications.show({color:"green",message:"分享链接已复制到剪贴板"})})})(e),children:"分享"}),(0,i.jsx)(T.Menu.Item,{leftSection:"✏️",onClick:()=>{Q(e),J(e.name),q(""),V()},children:"重命名"}),(0,i.jsx)(T.Menu.Divider,{}),(0,i.jsx)(T.Menu.Item,{leftSection:"\uD83D\uDDD1️",onClick:()=>es(e),children:"删除"})]})]})]})})},e.name))}),en&&(0,i.jsx)(v.Center,{children:(0,i.jsxs)(A.Button,{variant:"light",onClick:()=>{x(e=>e+100)},size:"md",children:["继续加载 (",ee.length-u," 个剩余)"]})})]})]}),!e&&(0,i.jsx)(v.Center,{children:(0,i.jsx)(A.Button,{variant:"gradient",component:d(),href:"/login",children:"去登录"})}),(0,i.jsx)(I.Modal,{opened:f,onClose:er,title:"创建新笔记",centered:!0,children:(0,i.jsxs)(m.Stack,{gap:"md",children:[(0,i.jsx)(w.TextInput,{placeholder:"请输入笔记名称",value:P,onChange:e=>{B(e.currentTarget.value),H("")},error:G,autoFocus:!0}),(0,i.jsxs)(h.Group,{justify:"flex-end",children:[(0,i.jsx)(A.Button,{variant:"default",onClick:er,children:"取消"}),(0,i.jsx)(A.Button,{loading:R,onClick:ea,children:"创建"})]})]})}),(0,i.jsx)(I.Modal,{opened:_,onClose:eo,title:"重命名笔记",centered:!0,children:(0,i.jsxs)(m.Stack,{gap:"md",children:[(0,i.jsx)(w.TextInput,{placeholder:"请输入新的笔记名称",value:U,onChange:e=>{J(e.currentTarget.value),q("")},error:X,autoFocus:!0}),(0,i.jsxs)(h.Group,{justify:"flex-end",children:[(0,i.jsx)(A.Button,{variant:"default",onClick:eo,children:"取消"}),(0,i.jsx)(A.Button,{loading:Z,onClick:el,children:"确认"})]})]})})]})}let _=JSON.parse('["没有调查，就没有发言权","我为人人，人人为我","具体问题，具体分析","不同条件，不同结果","实践是检验真理的唯一标准","从最坏处着眼，往最好处努力","见微知著","读史以明志，鉴往而知来","爱的本质是付出","团结 紧张 严肃 活泼","出发就能到达","没说不行就是可以","真正的勇士敢于直面惨淡的人生和淋漓的鲜血","君子用人如器，各取所长","合抱之木，生于毫末","九层之台，起于累土","千里之行，始于足下","出发就能到达","人生的最高法则是什么：斗争","广厦千间，夜眠仅需六尺","不积跬步，无以至千里也","你若一往无前，自有人紧跟相随","家财万贯，日食不过三餐","碌碌百载，终归仅需寸土","芸芸众生，遍寻不过一人","把事情变简单","凡夫畏果，菩萨畏因","光灿烂时，星已死灭","聪明是一种天赋，而善良是一种选择","你打你的，我打我的","以斗争求和平则和平存，以妥协求和平则和平亡","抓住主要矛盾不放手"]');var V=n(91590),W=n(93751),K=n(53776),Q=n(5821),U=n(91082);function J(){let[e,t]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=Math.floor(Math.random()*_.length);t(_[e])},[]);let n=(0,U.B)(),l=async()=>{s.current&&(await n.initViewer(s.current)).setMarkdown("IPFS (InterPlanetary File System) 是一种点对点的分布式文件系统协议。旨在创建一个更开放、更快速、更安全、更持久化的网络，以取代或补充目前主导互联网的 http 协议。\r\n\r\n**核心思想：从“位置寻址”到“内容寻址”**\r\n\r\n- IPFS: 你通过一个内容本身的唯一加密哈希值 (称为 CID - Content Identifier) 来访问内容。这个哈希值就像是内容的数字指纹，完全由内容本身计算得来。只要内容不变，哈希值就不变。这称为 “内容寻址” - 你通过内容本身（其指纹）请求内容。\r\n"),o.current&&(await n.initViewer(o.current)).setMarkdown("IPv6 (Internet Protocol version 6) 是下一代互联网的核心协议，旨在解决 IPv4 地址枯竭问题并提升网络性能。\r\n\r\n**核心功能：每个设备可拥有全球唯一公网 IP，消除对 NAT 的依赖，回归端到端通信。**\r\n\r\n- IPv4 的 32 位地址（约 43 亿个）已耗尽。IPv6 采用 128 位地址，提供近乎无限的地址空间，满足物联网、5G 等海量设备连接需求。\r\n\r\n- [test-ipv6.com](https://test-ipv6.com) | [itdog.cn](https://www.itdog.cn/localhost) | [ipw.cn](https://ipw.cn) | [test6.ustc.edu.cn](https://test6.ustc.edu.cn) 可以测试当前网络是否支持 IPv6\r\n")},s=(0,a.useRef)(null),o=(0,a.useRef)(null),c=(0,p.k)(e=>e.nodeDark);return(0,a.useEffect)(()=>{l()},[]),(0,i.jsxs)(V.Container,{py:"md",children:[(0,i.jsx)(W.Title,{size:"h3",children:"Most.Box - 如影随形"}),(0,i.jsx)(r.Text,{c:"dimmed",children:"——「轻松简单、开源免费、部署自己的云盘」"}),(0,i.jsx)(K.Divider,{my:"md"}),(0,i.jsxs)(Q.Accordion,{my:"md",variant:"separated",defaultValue:"IPFS",children:[(0,i.jsxs)(Q.Accordion.Item,{value:"IPFS",children:[(0,i.jsx)(Q.Accordion.Control,{icon:"\uD83C\uDF4E",children:"1. IPFS"}),(0,i.jsx)(Q.Accordion.Panel,{children:(0,i.jsx)(u.Box,{className:c,ref:s})})]}),(0,i.jsxs)(Q.Accordion.Item,{value:"IPv6",children:[(0,i.jsx)(Q.Accordion.Control,{icon:"\uD83C\uDF4C",children:"2. 公网 IPV6"}),(0,i.jsx)(Q.Accordion.Panel,{children:(0,i.jsx)(u.Box,{className:c,ref:o})})]}),(0,i.jsxs)(Q.Accordion.Item,{value:"DOT",children:[(0,i.jsx)(Q.Accordion.Control,{icon:"\uD83E\uDD66",children:"3. 运行节点"}),(0,i.jsx)(Q.Accordion.Panel,{children:"Crisp and refreshing fruit. Apples are known for their versatility and nutritional benefits. They come in a variety of flavors and are great for snacking, baking, or adding to salads."})]})]}),(0,i.jsx)(W.Title,{size:"h3",children:"使用说明"}),(0,i.jsx)(r.Text,{c:"dimmed",children:"——「回归数据存储本质」"}),(0,i.jsx)(K.Divider,{my:"md"}),(0,i.jsxs)(Q.Accordion,{my:"md",variant:"separated",children:[(0,i.jsxs)(Q.Accordion.Item,{value:"DOT",children:[(0,i.jsx)(Q.Accordion.Control,{icon:"\uD83E\uDD95",children:"节点切换"}),(0,i.jsx)(Q.Accordion.Panel,{children:"Crisp and refreshing fruit. Apples are known for their versatility and nutritional benefits. They come in a variety of flavors and are great for snacking, baking, or adding to salads."})]}),(0,i.jsxs)(Q.Accordion.Item,{value:"NOTE",children:[(0,i.jsx)(Q.Accordion.Control,{icon:"✏️",children:"笔记"}),(0,i.jsx)(Q.Accordion.Panel,{children:"Crisp and refreshing fruit. Apples are known for their versatility and nutritional benefits. They come in a variety of flavors and are great for snacking, baking, or adding to salads."})]}),(0,i.jsxs)(Q.Accordion.Item,{value:"IPFS",children:[(0,i.jsx)(Q.Accordion.Control,{icon:"\uD83D\uDCC2",children:"文件系统"}),(0,i.jsx)(Q.Accordion.Panel,{children:"Crisp and refreshing fruit. Apples are known for their versatility and nutritional benefits. They come in a variety of flavors and are great for snacking, baking, or adding to salads."})]})]}),(0,i.jsx)(K.Divider,{my:"md"}),(0,i.jsx)(h.Group,{justify:"flex-end",children:(0,i.jsxs)(r.Text,{c:"dimmed",children:["——「",e,"」"]})})]})}n(44017);var X=n(80630);let q=e=>{let{homeTab:t}=e,n=(0,p.k)(e=>e.wallet),s=(0,p.k)(e=>e.setItem),r=(0,p.k)(e=>e.filesPath),c=(0,a.useRef)(null),d=async e=>{var t,n;let i=null==(t=e.target.files)?void 0:t[0];if(!i)return;if(!i.name.endsWith(".tar"))return void N.notifications.show({title:"格式错误",message:"只支持 .tar 格式的压缩包",color:"red"});let a=N.notifications.show({title:"导入中",message:"正在解压并导入文件...",color:"blue",autoClose:!1});try{let e=new FormData;e.append("file",i),e.append("path",r);let t=await S.FH.put("/files.import",e),n=t.data.name,l=i.name.replace(/\.tar$/,""),o=r?"".concat(r,"/").concat(n):n,c=r?"".concat(r,"/").concat(l):l;await S.FH.put("/files.rename",{oldName:"/".concat(o),newName:"/".concat(c)}),N.notifications.update({id:a,title:"导入成功",message:t.data.message,color:"green",autoClose:!0});try{let e=await S.FH.post("/files/".concat(r));s("files",e.data)}catch(e){console.error(e)}}catch(t){let e=(null==t||null==(n=t.response)?void 0:n.data)||"导入失败，请重试";N.notifications.update({id:a,title:"导入失败",message:e,color:"red",autoClose:!0})}e.target.value=""};return"file"===t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(T.Menu,{shadow:"md",children:[(0,i.jsx)(T.Menu.Target,{children:(0,i.jsx)(l.ActionIcon,{variant:"transparent",color:"--text-color",children:(0,i.jsx)(o.I,{name:"More",size:24})})}),(0,i.jsx)(T.Menu.Dropdown,{children:(0,i.jsx)(T.Menu.Item,{leftSection:"\uD83D\uDCC1",onClick:()=>{var e;null==(e=c.current)||e.click()},disabled:!n,children:"导入 tar 压缩包"})})]}),(0,i.jsx)("input",{ref:c,type:"file",accept:".tar",style:{display:"none"},onChange:d})]}):(0,i.jsx)(l.ActionIcon,{variant:"transparent",color:"--text-color",onClick:()=>N.notifications.show({message:"没有更多"}),children:(0,i.jsx)(o.I,{name:"More",size:24})})};function Z(){let[e,t]=(0,a.useState)(null),n=(0,p.k)(e=>e.dotAPI);(0,a.useEffect)(()=>{t(localStorage.getItem("homeTab")||"explore")},[]);let c=(0,a.useMemo)(()=>{try{return new URL(n).host.toUpperCase()}catch(e){return"MOST.BOX"}},[n]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(X.AppHeader,{title:c,left:(0,i.jsx)(l.ActionIcon,{variant:"transparent",color:"--text-color",component:d(),href:"/dot",children:(0,i.jsx)(o.I,{name:"Earth",size:24})}),right:(0,i.jsx)(q,{homeTab:e})}),(0,i.jsxs)(s.Tabs,{id:"page-home",variant:"pills",radius:0,value:e,onChange:e=>{t(e),localStorage.setItem("homeTab",e||"explore")},children:[(0,i.jsx)(s.Tabs.Panel,{keepMounted:!0,value:"file",children:(0,i.jsx)(R,{})}),(0,i.jsx)(s.Tabs.Panel,{keepMounted:!0,value:"note",children:(0,i.jsx)(L,{})}),(0,i.jsx)(s.Tabs.Panel,{keepMounted:!0,value:"explore",children:(0,i.jsx)(J,{})}),(0,i.jsx)(s.Tabs.Panel,{keepMounted:!0,value:"mine",children:(0,i.jsx)(f,{})}),(0,i.jsxs)(s.Tabs.List,{children:[(0,i.jsxs)(s.Tabs.Tab,{value:"file",children:[(0,i.jsx)(o.I,{name:"file"===e?"FileActive":"File"}),(0,i.jsx)(r.Text,{children:"文件"})]}),(0,i.jsxs)(s.Tabs.Tab,{value:"note",children:[(0,i.jsx)(o.I,{name:"note"===e?"NoteActive":"Note"}),(0,i.jsx)(r.Text,{children:"笔记"})]}),(0,i.jsxs)(s.Tabs.Tab,{value:"explore",children:[(0,i.jsx)(o.I,{name:"explore"===e?"ExploreActive":"Explore"}),(0,i.jsx)(r.Text,{children:"探索"})]}),(0,i.jsxs)(s.Tabs.Tab,{value:"mine",children:[(0,i.jsx)(o.I,{name:"mine"===e?"MineActive":"Mine"}),(0,i.jsx)(r.Text,{children:"我的"})]})]})]})]})}},29439:()=>{},41698:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});let i=(0,n(86467).A)("outline","refresh","Refresh",[["path",{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4",key:"svg-0"}],["path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4",key:"svg-1"}]])},44017:()=>{},54395:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});let i=(0,n(86467).A)("outline","x","X",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]])},69570:()=>{},83572:()=>{},86467:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(12115),a={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}};let l=(e,t,n,l)=>{let s=(0,i.forwardRef)((n,s)=>{let{color:r="currentColor",size:o=24,stroke:c=2,title:d,className:u,children:h,...x}=n;return(0,i.createElement)("svg",{ref:s,...a[e],width:o,height:o,className:["tabler-icon","tabler-icon-".concat(t),u].join(" "),..."filled"===e?{fill:r}:{strokeWidth:c,stroke:r},...x},[d&&(0,i.createElement)("title",{key:"svg-title"},d),...l.map(e=>{let[t,n]=e;return(0,i.createElement)(t,n)}),...Array.isArray(h)?h:[h]])});return s.displayName="".concat(n),s}},92826:(e,t,n)=>{Promise.resolve().then(n.bind(n,10097))}},e=>{e.O(0,[2707,8198,2545,642,4771,8805,8413,6634,3722,3464,2996,4726,3187,7361,6874,6305,1697,3839,630,6933,8441,5964,7358],()=>e(e.s=92826)),_N_E=e.O()}]);