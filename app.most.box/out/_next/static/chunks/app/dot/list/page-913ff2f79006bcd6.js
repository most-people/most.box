(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9591],{4673:(e,t,s)=>{"use strict";s.d(t,{BP:()=>h,OM:()=>g,yO:()=>p});var n=s(30167),r=s(71425),a=s(44532),i=s(87788),l=s(56076),o=s(51544),c=s(70358),d=s(26634),m=s.n(d);let h=(e,t,s)=>{let c=(0,n.YW)(t),d=(0,n.YW)("/most.box/"+e),h=(0,r.A)(c,d,3,32,"sha512"),p=(0,a.q5)((0,i.s)(h)),g=p.slice(0,32),x=m().box.keyPair.fromSecretKey(g),u=(0,a.c$)(x.publicKey),y=(0,a.c$)(x.secretKey),j=l.v.entropyToPhrase(p);return{username:e,address:o.QX.fromPhrase(j).address,public_key:u,private_key:y,mnemonic:"I know loss mnemonic will lose my wallet."===s?j:""}},p=(e,t,s)=>{let n=new TextEncoder().encode(e),r=m().randomBytes(m().box.nonceLength),i=m().box(n,r,new Uint8Array((0,a.q5)(t)),new Uint8Array((0,a.q5)(s)));return i?["mp://2",(0,c.W)(r),(0,c.W)(i)].join("."):(console.info("加密失败"),"")},g=(e,t,s)=>{let[n,r,i]=e.split(".");if("mp://2"!==n)return console.info("无效的密文"),"";let l=m().box.open((0,c.y)(i),(0,c.y)(r),new Uint8Array((0,a.q5)(t)),new Uint8Array((0,a.q5)(s)));return l?new TextDecoder().decode(l):(console.info("解密失败"),"")}},7248:(e,t,s)=>{"use strict";s.d(t,{h:()=>r});var n=s(35695);let r=()=>{let e=(0,n.useRouter)(),t=(0,n.usePathname)();return()=>{sessionStorage.firstPath===t?(sessionStorage.firstPath="/",e.replace("/")):e.back()}}},9482:(e,t,s)=>{"use strict";s.d(t,{A:()=>w});var n=s(70358),r=s(30167),a=s(51544),i=s(19396),l=s(96842),o=s(42995),c=s(3648),d=s(4673),m=s(30832),h=s.n(m),p=s(99758),g=s.n(p);s(38464);var x=s(76920),u=s.n(x);h().extend(u()),h().extend(g()),h().locale("zh-cn");let y=e=>{let t=String(Date.now()),s=(0,n.W)(crypto.getRandomValues(new Uint8Array(32))),r=sessionStorage.getItem("fingerprint")||"",a=[t,s].join("."),{public_key:i,private_key:l}=(0,d.BP)(r,a);return{jwt:(0,d.yO)(JSON.stringify(e),i,l),jwtSecret:a}},j=(e,t)=>{let[s]=t.split(".");if(Date.now()-Number(s)>864e5)return console.log("jwt 已过期"),null;try{let s=sessionStorage.getItem("fingerprint")||"",{public_key:n,private_key:r}=(0,d.BP)(s,t),a=(0,d.OM)(e,n,r);if(a)return JSON.parse(a)}catch(e){console.log("验证失败:",e)}return null},v=async e=>{let t=Date.now().toString(),s=a.QX.fromPhrase(e.mnemonic),n=await s.signMessage(t);localStorage.token=[e.address,t,n].join(".")},f=async()=>{try{let e=new Audio("/sounds/notification.mp3");await e.play(),navigator.vibrate(200)}catch(e){console.log("播放提示音时出错:",e)}},w={topic:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Most";return(0,l.gn)(c,{seed:"most.box#"+e,flip:!0,backgroundType:["gradientLinear","solid"]}).toDataUri()},avatar:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Most";return(0,l.gn)(o,{seed:"most.box@"+e,flip:!0,backgroundType:["gradientLinear"]}).toDataUri()},getHash:e=>{let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+e.charCodeAt(s),t&=t;return Math.abs(t).toString(36)},formatTime:e=>{let t;if(!e)return"";let s=h()(Number(e)),n=s.hour();return t=n>=0&&n<3?"凌晨":n>=3&&n<6?"拂晓":n>=6&&n<9?"早晨":n>=9&&n<12?"上午":n>=12&&n<15?"下午":n>=15&&n<18?"傍晚":n>=18&&n<21?"薄暮":"深夜",s.format("YYYY年M月D日 ".concat(t,"h点m分"))},formatDate:e=>{let t=h()(Number(e)),s=h()();return t.isSame(s,"day")?t.format("HH:mm"):t.isSame(s.subtract(1,"day"),"day")?"昨天 ".concat(t.format("HH:mm")):t.isoWeek()===s.isoWeek()?"".concat(["周日","周一","周二","周三","周四","周五","周六"][t.day()]," ").concat(t.format("HH:mm")):t.year()===s.year()?t.format("M月D日"):t.format("YY年M月D日")},formatAddress:e=>e?e.slice(0,6)+"..."+e.slice(-4):"",enBase64:e=>(0,n.W)((0,r.YW)(e)),deBase64:e=>(0,r._v)((0,n.y)(e)),createJWT:y,verifyJWT:j,login:(e,t)=>{try{var s;let n=(0,d.BP)(e,t,"I know loss mnemonic will lose my wallet."),{jwt:r,jwtSecret:a}=y(n);if((null==(s=j(r,a))?void 0:s.address)===n.address)return localStorage.setItem("jwt",r),localStorage.setItem("jwtSecret",a),v(n),n}catch(e){console.log("登录失败:",e)}return null},ZeroAddress:i.j,topicJoin:(e,t)=>t?[e,t].join("➔"):e,topicSplit:e=>{e.startsWith("#")&&(e=e.substring(1));let[t,s]=decodeURIComponent(e).split("➔");return[t||"",s||""]},playSound:f,createToken:v}},27142:()=>{},29115:(e,t,s)=>{Promise.resolve().then(s.bind(s,72359))},54395:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var n=(0,s(86467).A)("outline","x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]])},71281:()=>{},72359:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>G});var n=s(95155),r=s(80630),a=s(69604),i=s(91590),l=s(97287),o=s(35049),c=s(93751),d=s(58887),m=s(74634),h=s(26903),p=s(70058),g=s(70112),x=s(15763),u=s(27361),y=s(81001),j=s(89047),v=s(18403),f=s(26029),w=s(53776),k=s(21220),b=s(12115),A=s(89902),T=s(11681),M=s(6942),z=s(86467),I=(0,z.A)("outline","network","IconNetwork",[["path",{d:"M6 9a6 6 0 1 0 12 0a6 6 0 0 0 -12 0",key:"svg-0"}],["path",{d:"M12 3c1.333 .333 2 2.333 2 6s-.667 5.667 -2 6",key:"svg-1"}],["path",{d:"M12 3c-1.333 .333 -2 2.333 -2 6s.667 5.667 2 6",key:"svg-2"}],["path",{d:"M6 9h12",key:"svg-3"}],["path",{d:"M3 20h7",key:"svg-4"}],["path",{d:"M14 20h7",key:"svg-5"}],["path",{d:"M10 20a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-6"}],["path",{d:"M12 15v3",key:"svg-7"}]]),S=(0,z.A)("outline","server","IconServer",[["path",{d:"M3 4m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v2a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z",key:"svg-0"}],["path",{d:"M3 12m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v2a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z",key:"svg-1"}],["path",{d:"M7 8l0 .01",key:"svg-2"}],["path",{d:"M7 16l0 .01",key:"svg-3"}]]),C=s(54395),D=(0,z.A)("outline","refresh","IconRefresh",[["path",{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4",key:"svg-0"}],["path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4",key:"svg-1"}]]),B=(0,z.A)("outline","wifi","IconWifi",[["path",{d:"M12 18l.01 0",key:"svg-0"}],["path",{d:"M9.172 15.172a4 4 0 0 1 5.656 0",key:"svg-1"}],["path",{d:"M6.343 12.343a8 8 0 0 1 11.314 0",key:"svg-2"}],["path",{d:"M3.515 9.515c4.686 -4.687 12.284 -4.687 17 0",key:"svg-3"}]]),P=(0,z.A)("outline","wifi-off","IconWifiOff",[["path",{d:"M12 18l.01 0",key:"svg-0"}],["path",{d:"M9.172 15.172a4 4 0 0 1 5.656 0",key:"svg-1"}],["path",{d:"M6.343 12.343a7.963 7.963 0 0 1 3.864 -2.14m4.163 .155a7.965 7.965 0 0 1 3.287 2",key:"svg-2"}],["path",{d:"M3.515 9.515a12 12 0 0 1 3.544 -2.455m3.101 -.92a12 12 0 0 1 10.325 3.374",key:"svg-3"}],["path",{d:"M3 3l18 18",key:"svg-4"}]]),O=(0,z.A)("outline","check","IconCheck",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]),N=(0,z.A)("outline","database","IconDatabase",[["path",{d:"M12 6m-8 0a8 3 0 1 0 16 0a8 3 0 1 0 -16 0",key:"svg-0"}],["path",{d:"M4 6v6a8 3 0 0 0 16 0v-6",key:"svg-1"}],["path",{d:"M4 12v6a8 3 0 0 0 16 0v-6",key:"svg-2"}]]),W=(0,z.A)("outline","clock","IconClock",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 7v5l3 3",key:"svg-1"}]]),H=s(9482);s(27142);let Y=[{inputs:[],name:"getAllDots",outputs:[{internalType:"address[]",name:"addresses",type:"address[]"},{internalType:"string[]",name:"names",type:"string[]"},{internalType:"uint256[]",name:"timestamps",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"dot",type:"address"}],name:"getDot",outputs:[{internalType:"string",name:"name",type:"string"},{internalType:"string[]",name:"APIs",type:"string[]"},{internalType:"string[]",name:"CIDs",type:"string[]"},{internalType:"uint256",name:"update",type:"uint256"}],stateMutability:"view",type:"function"}];function G(){let[e,t]=(0,b.useState)([]),[s,z]=(0,b.useState)(!0),[G,U]=(0,b.useState)(!1),[E,_]=(0,b.useState)(null),[L,R]=(0,b.useState)("testnet"),q={mainnet:{rpc:"https://mainnet.base.org",name:"Base 主网",color:"blue"},testnet:{rpc:"https://sepolia.base.org",name:"Base 测试网",color:"orange"}},F=q[L].rpc,J=async()=>{try{z(!0),_(null);let e=new A.FR(F),s=new T.NZ("0xdc82cef1a8416210afb87caeec908a4df843f016",Y,e),[n,r,a]=await s.getAllDots(),i=n.map(async(e,t)=>{let[n,i,l,o]=await s.getDot(e);return{address:e,name:n||r[t]||"节点 ".concat(t+1),APIs:i||[],CIDs:l||[],lastUpdate:Number(o||a[t])}}),l=await Promise.all(i);t(l)}catch(e){console.error("获取节点列表失败:",e),_("获取节点列表失败，请检查网络连接"),M.notifications.show({title:"获取失败",message:"无法获取节点列表",color:"red"})}finally{z(!1)}},K=e=>{let t=e.APIs[0];return new Promise(e=>{let s=new Image,n=Date.now(),r=setTimeout(()=>{e({isOnline:!1,responseTime:3e3})},3e3);s.onload=()=>{clearTimeout(r),e({isOnline:!0,responseTime:Date.now()-n})},s.onerror=()=>{clearTimeout(r),e({isOnline:!1,responseTime:Date.now()-n})},s.src="".concat(t,"/ping?_=").concat(Date.now())})},X=async()=>{U(!0);try{let s=await Promise.all(e.map(async e=>{let{isOnline:t,responseTime:s}=await K(e);return{...e,isOnline:t,responseTime:s}}));t(s);let n=s.filter(e=>e.isOnline).length;M.notifications.show({title:"连通性检测完成",message:"".concat(n,"/").concat(s.length," 个节点在线"),color:n>0?"green":"orange"})}catch(e){console.log("连通性检测失败:",e),M.notifications.show({title:"检测失败",message:"连通性检测过程中出现错误",color:"red"})}finally{U(!1)}},Q=e=>e?new Date(1e3*e).toLocaleString("zh-CN"):"未知",Z=e=>void 0===e?"":"".concat(e,"ms");if((0,b.useEffect)(()=>{J()},[L]),s)return(0,n.jsxs)(a.Box,{id:"page-dot-list",children:[(0,n.jsx)(r.AppHeader,{title:"节点列表"}),(0,n.jsx)(i.Container,{size:"lg",py:"xl",children:(0,n.jsxs)(l.Paper,{p:"xl",radius:"md",style:{textAlign:"center"},children:[(0,n.jsx)(o.ThemeIcon,{size:60,radius:"xl",variant:"light",color:"blue",mb:"md",children:(0,n.jsx)(S,{size:30})}),(0,n.jsx)(c.Title,{order:3,c:"dimmed",children:"正在加载节点列表..."}),(0,n.jsx)(d.Text,{size:"sm",c:"dimmed",mt:"xs",children:"请稍候，正在从区块链获取数据"})]})})]});if(E)return(0,n.jsxs)(a.Box,{id:"page-dot-list",children:[(0,n.jsx)(r.AppHeader,{title:"节点列表"}),(0,n.jsx)(i.Container,{size:"lg",py:"xl",children:(0,n.jsxs)(l.Paper,{shadow:"sm",p:"xl",radius:"md",children:[(0,n.jsx)(m.Alert,{color:"red",title:"加载失败",icon:(0,n.jsx)(C.A,{size:16}),children:E}),(0,n.jsx)(h.Button,{mt:"md",onClick:J,leftSection:(0,n.jsx)(D,{size:16}),variant:"light",color:"red",children:"重新加载"})]})})]});let $=e.filter(e=>e.isOnline),V=e.filter(e=>!1===e.isOnline);return(0,n.jsxs)(a.Box,{id:"page-dot-list",children:[(0,n.jsx)(r.AppHeader,{title:"节点列表"}),(0,n.jsxs)(i.Container,{size:"lg",py:"md",children:[(0,n.jsx)(l.Paper,{shadow:"sm",p:"lg",radius:"md",mb:"lg",children:(0,n.jsxs)(p.Flex,{justify:"space-between",align:"center",wrap:"wrap",gap:"md",children:[(0,n.jsxs)(g.Group,{children:[(0,n.jsx)(o.ThemeIcon,{size:40,radius:"md",variant:"light",color:"blue",children:(0,n.jsx)(S,{size:20})}),(0,n.jsxs)(a.Box,{children:[(0,n.jsx)(c.Title,{order:2,children:"节点监控"}),(0,n.jsxs)(d.Text,{size:"sm",c:"dimmed",children:["共 ",e.length," 个节点",e.some(e=>void 0!==e.isOnline)&&(0,n.jsxs)(n.Fragment,{children:[" ","• ",$.length," 在线 • ",V.length," 离线"]})]})]})]}),(0,n.jsxs)(g.Group,{children:[(0,n.jsx)(x.Select,{value:L,onChange:e=>{e&&("mainnet"===e||"testnet"===e)&&(R(e),M.notifications.show({title:"网络已切换",message:"已切换到 ".concat(q[e].name),color:q[e].color,icon:(0,n.jsx)(I,{size:16})}))},data:[{value:"testnet",label:"\uD83E\uDDEA Base 测试网"},{value:"mainnet",label:"\uD83C\uDF10 Base 主网"}],leftSection:(0,n.jsx)(I,{size:16}),variant:"filled",radius:"md",w:180}),(0,n.jsx)(u.Tooltip,{label:"刷新节点列表",children:(0,n.jsx)(y.ActionIcon,{size:"lg",variant:"light",color:"blue",onClick:J,loading:s,children:(0,n.jsx)(D,{size:18})})}),(0,n.jsx)(h.Button,{leftSection:(0,n.jsx)(B,{size:16}),onClick:X,loading:G,disabled:0===e.length,variant:"gradient",gradient:{from:"blue",to:"cyan"},children:"检测连通性"})]})]})}),(0,n.jsx)(m.Alert,{mb:"lg",color:q[L].color,variant:"light",icon:(0,n.jsx)(I,{size:16}),title:"当前网络: ".concat(q[L].name),children:(0,n.jsxs)(d.Text,{size:"sm",children:["RPC 端点:"," ",(0,n.jsx)(d.Text,{component:"span",ff:"monospace",c:"dimmed",children:q[L].rpc})]})}),0===e.length?(0,n.jsxs)(l.Paper,{shadow:"sm",p:"xl",radius:"md",style:{textAlign:"center"},children:[(0,n.jsx)(o.ThemeIcon,{size:60,radius:"xl",variant:"light",color:"gray",mb:"md",children:(0,n.jsx)(S,{size:30})}),(0,n.jsx)(c.Title,{order:3,c:"dimmed",mb:"xs",children:"暂无节点"}),(0,n.jsx)(d.Text,{size:"sm",c:"dimmed",children:"当前网络没有注册的节点"})]}):(0,n.jsx)(j.Grid,{children:e.map(e=>(0,n.jsx)(j.Grid.Col,{span:{base:12,md:6,lg:4},children:(0,n.jsxs)(v.Card,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,h:"100%",style:{transition:"transform 0.2s ease, box-shadow 0.2s ease",cursor:"pointer"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 20px rgba(0,0,0,0.1)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow=""},children:[(0,n.jsxs)(g.Group,{justify:"space-between",mb:"md",children:[(0,n.jsxs)(g.Group,{children:[(0,n.jsx)(o.ThemeIcon,{size:36,radius:"md",variant:"light",color:e.isOnline?"green":!1===e.isOnline?"red":"gray",children:e.isOnline?(0,n.jsx)(B,{size:18}):!1===e.isOnline?(0,n.jsx)(P,{size:18}):(0,n.jsx)(S,{size:18})}),(0,n.jsxs)(a.Box,{children:[(0,n.jsx)(d.Text,{fw:600,size:"md",lineClamp:1,children:e.name}),(0,n.jsx)(d.Text,{size:"xs",c:"dimmed",children:"节点地址"})]})]}),void 0!==e.isOnline&&(0,n.jsxs)(f.Badge,{color:e.isOnline?"green":"red",variant:"light",leftSection:e.isOnline?(0,n.jsx)(O,{size:12}):(0,n.jsx)(C.A,{size:12}),children:[e.isOnline?"在线":"离线",void 0!==e.responseTime&&" (".concat(Z(e.responseTime),")")]})]}),(0,n.jsx)(w.Divider,{mb:"md"}),(0,n.jsxs)(k.Stack,{gap:"sm",children:[(0,n.jsxs)(g.Group,{gap:"xs",wrap:"nowrap",children:[(0,n.jsx)(N,{size:14,color:"gray",style:{flexShrink:0}}),(0,n.jsx)(d.Text,{size:"xs",c:"dimmed",children:H.A.formatAddress(e.address)})]}),(0,n.jsxs)(g.Group,{gap:"xs",children:[(0,n.jsx)(W,{size:14,color:"gray"}),(0,n.jsx)(d.Text,{size:"xs",c:"dimmed",children:Q(e.lastUpdate)})]}),e.APIs.length>0&&(0,n.jsx)(k.Stack,{gap:2,children:e.APIs.map((e,t)=>(0,n.jsx)(d.Text,{c:"blue",component:"a",href:e,target:"_blank",style:{textDecoration:"none"},lineClamp:1,children:e},t))}),e.CIDs.length>0&&(0,n.jsxs)(a.Box,{children:[(0,n.jsxs)(d.Text,{size:"xs",fw:500,mb:4,c:"grape",children:["CID 列表 (",e.CIDs.length,")"]}),(0,n.jsxs)(g.Group,{gap:4,children:[e.CIDs.slice(0,2).map((e,t)=>(0,n.jsx)(f.Badge,{variant:"light",size:"xs",color:"grape",style:{fontFamily:"monospace"},children:e.length>8?"".concat(e.slice(0,8),"..."):e},t)),e.CIDs.length>2&&(0,n.jsxs)(f.Badge,{variant:"outline",size:"xs",c:"dimmed",children:["+",e.CIDs.length-2]})]})]})]})]})},e.address))})]})]})}},80630:(e,t,s)=>{"use strict";s.d(t,{AppHeader:()=>c});var n=s(95155),r=s(70112),a=s(81001),i=s(58887),l=s(30578),o=s(7248);let c=e=>{let{title:t,right:s}=e,c=(0,o.h)();return(0,n.jsxs)(r.Group,{className:"app-header",children:[(0,n.jsx)(a.ActionIcon,{variant:"transparent",onClick:c,color:"--text-color",children:(0,n.jsx)(l.I,{name:"back",size:24})}),(0,n.jsx)(i.Text,{lineClamp:2,variant:"gradient",children:t}),s||(0,n.jsx)(a.ActionIcon,{variant:"transparent",color:"--text-color",children:(0,n.jsx)(l.I,{name:"more",size:24})})]})}},86467:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var n=s(12115),r={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}};let a=(e,t,s,a)=>{let i=(0,n.forwardRef)((s,i)=>{let{color:l="currentColor",size:o=24,stroke:c=2,title:d,className:m,children:h,...p}=s;return(0,n.createElement)("svg",{ref:i,...r[e],width:o,height:o,className:["tabler-icon","tabler-icon-".concat(t),m].join(" "),..."filled"===e?{fill:l}:{strokeWidth:c,stroke:l},...p},[d&&(0,n.createElement)("title",{key:"svg-title"},d),...a.map(e=>{let[t,s]=e;return(0,n.createElement)(t,s)}),...Array.isArray(h)?h:[h]])});return i.displayName="".concat(s),i}}},e=>{var t=t=>e(e.s=t);e.O(0,[5417,2545,9729,9816,5232,1281,5111,266,2269,9902,578,8441,2721,7358],()=>t(29115)),_N_E=e.O()}]);