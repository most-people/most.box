(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6988],{7248:(e,t,a)=>{"use strict";a.d(t,{h:()=>r});var s=a(35695);let r=()=>{let e=(0,s.useRouter)(),t=(0,s.usePathname)();return()=>{sessionStorage.firstPath===t?(sessionStorage.firstPath="/",e.replace("/")):e.back()}}},19894:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var s=a(95155),r=a(12115),n=a(80630),i=a(26903),o=a(21220),l=a(57001),c=a(6942),d=a(1973),u=a(62037),h=a(35695),p=a(17187),g=a(23464);let m=e=>{let t=(0,h.useRouter)(),[a,n]=(0,r.useState)(!1),o=async a=>{try{var s;(null==(s=(await (0,g.A)({method:"put",url:e.api+"/api.deploy",headers:{Authorization:a}})).data)?void 0:s.ok)&&(c.notifications.show({color:"green",title:"提示",message:"部署成功"}),t.back())}catch(e){console.error(e),c.notifications.show({color:"red",title:"提示",message:"部署失败"})}},l=async()=>{let e=Date.now().toString(),t=window.ethereum;if(t)try{n(!0);let a=new d.k(t),s=await a.getSigner(),r=await s.signMessage(e),i=[s.address,e,r].join(".");await o(i)}catch(e){c.notifications.show({color:"red",title:"提示",message:"签名失败"})}finally{n(!1)}};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(i.Button,{variant:"gradient",loading:a,loaderProps:{type:"dots"},onClick:l,children:"签名部署"})})};function w(){let e=(0,h.useRouter)(),[t,a]=(0,r.useState)(!1),[d,g]=(0,r.useState)(""),w={address:"",api:""};(0,r.useEffect)(()=>{let t=new URLSearchParams(window.location.search),a=t.get("address"),s=t.get("api");a&&s?(w.address=a,w.api=s):e.back()},[]);let f=async()=>{let e=window.ethereum;if(e)try{a(!0);let t=await e.request({method:"eth_requestAccounts"});if(t&&t.length>0){let e=(0,u.b)(t[0]);g(e)}}catch(e){c.notifications.show({title:"提示",message:e.message||"连接失败"})}finally{a(!1)}else c.notifications.show({title:"提示",message:"请先安装 OKX Wallet"});return null},x=async()=>{var e;let t=null==(e=window)?void 0:e.ethereum;t&&t.on("accountsChanged",e=>{e&&e.length>0?g((0,u.b)(e[0])):g("")})};return(0,r.useEffect)(()=>{x()},[]),(0,s.jsxs)(o.Stack,{children:[(0,s.jsx)(n.AppHeader,{title:"更新节点代码"}),(0,s.jsxs)(l.Blockquote,{icon:(0,s.jsx)(p.A,{}),mt:"xl",children:["节点地址：",w.api]}),d?(0,s.jsx)(i.Button,{variant:"default",onClick:()=>{c.notifications.show({title:"提示",message:"请在钱包插件中切换账号"})},children:d}):(0,s.jsx)(i.Button,{variant:"default",loading:t,loaderProps:{type:"dots"},onClick:f,children:"连接钱包"}),d&&(0,s.jsx)(s.Fragment,{children:w.api&&w.address===d?(0,s.jsx)(m,{...w}):(0,s.jsxs)(l.Blockquote,{color:"gray",cite:"most-people.com",icon:(0,s.jsx)(p.A,{}),mt:"xl",children:["请连接钱包：",w.address]})})]})}},40584:(e,t,a)=>{Promise.resolve().then(a.bind(a,19894))},80630:(e,t,a)=>{"use strict";a.d(t,{AppHeader:()=>c});var s=a(95155),r=a(70112),n=a(81001),i=a(58887),o=a(20042),l=a(7248);let c=e=>{let{title:t,right:a}=e,c=(0,l.h)();return(0,s.jsxs)(r.Group,{className:"app-header",children:[(0,s.jsx)(n.ActionIcon,{variant:"transparent",onClick:c,color:"--text-color",children:(0,s.jsx)(o.I,{name:"Back",size:24})}),(0,s.jsx)(i.Text,{lineClamp:2,variant:"gradient",children:t}),a||(0,s.jsx)(n.ActionIcon,{variant:"transparent",color:"--text-color",children:(0,s.jsx)(o.I,{name:"More",size:24})})]})}}},e=>{e.O(0,[8887,9549,8805,3464,9117,1171,42,8441,5881,7358],()=>e(e.s=40584)),_N_E=e.O()}]);