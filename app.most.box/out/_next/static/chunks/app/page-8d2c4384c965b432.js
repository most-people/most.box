(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{1072:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Y});var s=n(95155),l=n(12115),a=n(46647),i=n(58887),r=n(20042);n(29439);var o=n(6874),c=n.n(o),d=n(69604),u=n(70112),h=n(39926),m=n(81001),x=n(21220),g=n(6942),p=n(48764),j=n(9482);function f(){let e=(0,p.k)(e=>e.wallet),t=(null==e?void 0:e.address)||j.A.ZeroAddress,n=(0,p.k)(e=>e.exit);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Box,{className:"header",children:(0,s.jsxs)(u.Group,{wrap:"nowrap",children:[(0,s.jsx)(h.Avatar,{size:"md",radius:"sm",src:(null==e?void 0:e.address)?j.A.avatar(e.address):"/icons/pwa-512x512.png",alt:"it's me"}),(0,s.jsxs)(d.Box,{children:[(0,s.jsx)(i.Text,{size:"lg",fw:500,lineClamp:2,children:(null==e?void 0:e.username)||"Most.Box"}),(0,s.jsxs)(i.Text,{size:"sm",c:"dimmed",children:["地址: ",j.A.formatAddress(t)]})]}),(0,s.jsx)(m.ActionIcon,{ml:"auto",variant:"subtle",color:"gray",onClick:()=>g.notifications.show({title:"二维码",message:"开发中"}),children:(0,s.jsx)(r.I,{name:"QRCode",size:18})})]})}),(0,s.jsxs)(x.Stack,{className:"menu-list",mb:"xs",gap:0,children:[(0,s.jsx)(v,{icon:"Web3",label:"Web3",link:"/web3"}),(0,s.jsx)(v,{icon:"Earth",label:"节点",link:"/dot"})]}),(0,s.jsxs)(x.Stack,{className:"menu-list",gap:0,children:[(0,s.jsx)(v,{icon:"About",label:"关于",link:"/about"}),(0,s.jsx)(v,{icon:"Setting",label:"设置",link:"/setting"}),(0,s.jsx)(v,{icon:"Join",label:"志同道合",link:"/join"})]}),(0,s.jsx)(x.Stack,{className:"menu-list",mt:"xs",children:(0,s.jsx)(v,{icon:"Exit",label:e?"退出账户":"去登录",link:"/login",onClick:()=>{e&&n()}})})]})}function v(e){let{icon:t,label:n,link:l,onClick:a}=e;return(0,s.jsxs)(d.Box,{component:c(),href:l,className:"menu-item",onClick:a,children:[(0,s.jsxs)(u.Group,{children:[(0,s.jsx)(r.I,{name:t,size:32}),(0,s.jsx)(i.Text,{children:n})]}),(0,s.jsx)(r.I,{name:"Arrow",size:18})]})}var w=n(8141),k=n(26903),y=n(93695),b=n(63617),S=n(74271),A=n(97287),C=n(54205);n(97237);var I=n(86467);let T=(0,I.A)("outline","folder-plus","FolderPlus",[["path",{d:"M12 19h-7a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v3.5",key:"svg-0"}],["path",{d:"M16 19h6",key:"svg-1"}],["path",{d:"M19 16v6",key:"svg-2"}]]),M=(0,I.A)("outline","upload","Upload",[["path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M7 9l5 -5l5 5",key:"svg-1"}],["path",{d:"M12 4l0 12",key:"svg-2"}]]);var D=n(54395);function z(){let e=(0,p.k)(e=>e.wallet),t=(0,p.k)(e=>e.dotCID),n=(0,p.k)(e=>e.files),a=(0,p.k)(e=>e.setItem),[r,o]=(0,l.useState)(!1),[h,j]=(0,l.useState)([]),[f,v]=(0,l.useState)(!1),I=(0,l.useRef)(null),z=(0,l.useRef)(null),B=async()=>{try{let e=await C.FH.post("/files/");a("files",e.data)}catch(e){console.error(e)}},P=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]},N=async e=>{var t,n;if(e&&0!==e.length){o(!0);try{for(let n=0;n<e.length;n++){let s=e[n],l=new FormData;l.append("file",s),l.append("path",s.webkitRelativePath),(null==(t=(await C.FH.put("/files.upload",l)).data)?void 0:t.cid)&&g.notifications.show({title:"上传成功",message:"文件 ".concat(s.name," 上传成功"),color:"green"})}await B(),v(!1),j([])}catch(t){let e=(null==t||null==(n=t.response)?void 0:n.data)||"文件上传失败，请重试";e.includes("already has")&&(e="文件已存在"),g.notifications.show({title:"上传失败",message:e,color:"red"})}finally{o(!1)}}},E=e=>{let t=e.target.files;if(t&&t.length>0){let e=Array.from(t);1!==e.length||e[0].webkitRelativePath?(j(e.map(e=>({file:e,path:e.webkitRelativePath||e.name,size:P(e.size)}))),v(!0)):N(e)}e.target.value=""},F=()=>{v(!1),j([])},G=async e=>{try{await C.FH.delete("/files/".concat(e)),g.notifications.show({title:"删除成功",message:"文件 ".concat(e," 已删除"),color:"green"}),await B()}catch(t){console.error("删除失败:",t),g.notifications.show({title:"删除失败",message:"删除文件 ".concat(e," 失败，请重试"),color:"red"})}};return((0,l.useEffect)(()=>{e&&!n&&B()},[e,n]),e)?(0,s.jsxs)(d.Box,{py:64,children:[(0,s.jsx)(x.Stack,{align:"center",gap:0,p:"md",children:(0,s.jsxs)(u.Group,{gap:4,children:[(0,s.jsx)("span",{children:"当前节点"}),(0,s.jsx)(y.Anchor,{component:c(),href:t+"/ipfs/",target:"_blank",children:t+"/ipfs/"})]})}),(0,s.jsxs)(x.Stack,{gap:"md",p:"md",children:[(0,s.jsx)("input",{ref:I,type:"file",multiple:!0,style:{display:"none"},onChange:E}),(0,s.jsx)("input",{ref:z,type:"file",webkitdirectory:"",multiple:!0,style:{display:"none"},onChange:E}),(0,s.jsxs)(u.Group,{mb:"md",gap:"sm",children:[(0,s.jsx)(m.ActionIcon,{variant:"filled",color:"blue",size:"lg",onClick:()=>{var e;null==(e=z.current)||e.click()},disabled:r,children:(0,s.jsx)(T,{})}),(0,s.jsx)(m.ActionIcon,{variant:"filled",color:"green",size:"lg",onClick:()=>{var e;null==(e=I.current)||e.click()},disabled:r,children:(0,s.jsx)(M,{})})]}),(0,s.jsx)(b.Modal,{opened:f,onClose:F,title:"文件预览",size:"lg",centered:!0,children:(0,s.jsxs)(x.Stack,{gap:"md",children:[(0,s.jsx)(u.Group,{justify:"space-between",children:(0,s.jsxs)(i.Text,{size:"sm",c:"dimmed",children:["共 ",h.length," 个文件，总大小: ",P(h.reduce((e,t)=>e+t.file.size,0))]})}),(0,s.jsx)(S.ScrollArea,{h:300,children:(0,s.jsx)(x.Stack,{gap:"xs",children:h.map((e,t)=>(0,s.jsx)(A.Paper,{p:"sm",withBorder:!0,children:(0,s.jsxs)(u.Group,{justify:"space-between",align:"center",wrap:"nowrap",children:[(0,s.jsxs)(u.Group,{align:"center",children:[(0,s.jsx)(i.Text,{size:"sm",children:"\uD83D\uDCC4"}),(0,s.jsxs)(x.Stack,{gap:2,children:[(0,s.jsx)(i.Text,{size:"sm",fw:500,children:e.path}),(0,s.jsx)(i.Text,{size:"xs",c:"dimmed",children:e.size})]})]}),(0,s.jsx)(m.ActionIcon,{variant:"subtle",color:"gray",onClick:()=>(e=>{let t=h.filter((t,n)=>n!==e);j(t),0===t.length&&v(!1)})(t),children:(0,s.jsx)(D.A,{})})]})},t))})}),(0,s.jsxs)(u.Group,{justify:"flex-end",gap:"sm",children:[(0,s.jsx)(k.Button,{variant:"outline",onClick:F,disabled:r,children:"取消"}),(0,s.jsx)(k.Button,{onClick:()=>{N(h.map(e=>e.file))},loading:r,disabled:0===h.length,children:"确认上传"})]})]})}),null==n?void 0:n.map((e,n)=>(0,s.jsx)(A.Paper,{p:"md",withBorder:!0,radius:"md",children:(0,s.jsxs)(u.Group,{justify:"space-between",align:"center",children:[(0,s.jsx)(u.Group,{align:"center",children:(0,s.jsxs)(i.Text,{fw:500,children:["directory"===e.type?"\uD83D\uDCC1":"\uD83D\uDCC4"," ",e.name]})}),(0,s.jsxs)(u.Group,{align:"center",children:[(0,s.jsx)(x.Stack,{gap:4,align:"flex-end",children:e.size>0&&(0,s.jsx)(i.Text,{size:"sm",c:"dimmed",children:P(e.size)})}),(0,s.jsx)(m.ActionIcon,{variant:"subtle",color:"gray",component:c(),href:"".concat(t,"/ipfs/").concat(e.cid["/"],"?filename=").concat(e.name),target:"_blank",children:"\uD83D\uDD0D"}),!("directory"===e.type&&e.name.startsWith("."))&&(0,s.jsx)(m.ActionIcon,{variant:"subtle",color:"gray",onClick:()=>{window.confirm('确定要删除文件 "'.concat(e.name,'" 吗？'))&&G(e.name)},children:"\uD83D\uDDD1️"})]})]})},n)),(null==n?void 0:n.length)===0&&(0,s.jsx)(i.Text,{ta:"center",c:"dimmed",children:"暂无文件"})]})]}):(0,s.jsx)(w.Center,{children:(0,s.jsx)(k.Button,{variant:"gradient",component:c(),href:"/login",children:"去登录"})})}n(83572);var B=n(26029),P=n(8593),N=n(89047),E=n(18403),F=n(59741);let G=(0,I.A)("outline","plus","Plus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]),W=(0,I.A)("outline","dots-vertical","DotsVertical",[["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M12 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}]]);var H=n(41698);n(6396);var R=n(11681);function L(){let e=(0,p.k)(e=>e.wallet),t=(0,p.k)(e=>e.notes),n=(0,p.k)(e=>e.setItem),[a,r]=(0,l.useState)(!1),[o,d]=(0,l.useState)(""),[h,f]=(0,l.useState)(100),[v,{open:y,close:S}]=(0,R.useDisclosure)(!1),[A,I]=(0,l.useState)(""),[T,M]=(0,l.useState)(""),[D,z]=(0,l.useState)(!1),[L,{open:O,close:U}]=(0,R.useDisclosure)(!1),[Y,_]=(0,l.useState)(null),[q,J]=(0,l.useState)(""),[K,Q]=(0,l.useState)(""),[V,X]=(0,l.useState)(!1),Z=t=>{let n=new URL(window.location.origin);return n.pathname="/note/",n.searchParams.set("uid",(null==e?void 0:e.address)||""),n.searchParams.set("name",t.name),n.hash=t.cid,n.href},$=t?t.filter(e=>j.A.pinyin(e.name,o,0)):[],ee=$.slice(0,h),et=$.length>h;(0,l.useEffect)(()=>{f(100)},[o]);let en=async()=>{try{r(!0);let e=(await C.FH.post("/files/.note")).data;if(e){let t=e.map(e=>({name:e.name,cid:e.cid["/"]}));n("notes",t)}}catch(e){g.notifications.show({message:e.message,color:"red"})}finally{r(!1)}},es=async()=>{let e=A.trim();if(!e)return void M("请输入笔记名称");if(null==t?void 0:t.some(t=>t.name===e))return void M("笔记名称已存在");try{var n;z(!0);let t=new FormData,s=new Blob(["# 新笔记\n\n✍️ 点击右上角编辑，记录你的灵感"],{type:"text/markdown"});t.append("file",s,"index.md"),t.append("path","/.note/".concat(e,"/index.md")),(null==(n=(await C.FH.put("/files.upload",t)).data)?void 0:n.cid)&&(g.notifications.show({color:"green",message:"笔记创建成功"}),await en(),S())}catch(e){g.notifications.show({color:"red",message:e instanceof Error?e.message:"创建失败，请重试"})}finally{z(!1)}},el=async()=>{if(!Y)return;let e=q.trim();if(!e)return void Q("请输入笔记名称");if(e===Y.name)return void U();if(null==t?void 0:t.some(t=>t.name===e))return void Q("笔记名称已存在");try{X(!0),await C.FH.post("/files/rename",{oldName:"/.note/".concat(Y.name),newName:"/.note/".concat(e)}),g.notifications.show({color:"green",message:"重命名成功"}),await en(),U()}catch(e){g.notifications.show({color:"red",message:e instanceof Error?e.message:"重命名失败"})}finally{X(!1)}},ea=async e=>{if(confirm('确定要删除笔记"'.concat(e.name,'"吗？此操作不可撤销。')))try{await C.FH.delete("/files/.note/".concat(e.name)),g.notifications.show({color:"green",message:"删除成功"}),await en()}catch(e){g.notifications.show({color:"red",message:e instanceof Error?e.message:"删除失败"})}},ei=()=>{I(""),M(""),S()},er=()=>{_(null),J(""),Q(""),U()};return((0,l.useEffect)(()=>{e&&!t&&en()},[e,t]),e)?(0,s.jsxs)(s.Fragment,{children:[(null==t?void 0:t.length)?(0,s.jsxs)(x.Stack,{gap:"md",p:"md",className:"note-box",children:[(0,s.jsxs)(u.Group,{justify:"space-between",align:"center",children:[(0,s.jsxs)(B.Badge,{variant:"light",size:"lg",children:[o?"显示 ".concat(ee.length," / ").concat($.length," (总共 ").concat(t.length,")"):"显示 ".concat(ee.length," / ").concat(t.length)," ","个笔记"]}),(0,s.jsx)(u.Group,{children:(0,s.jsx)(m.ActionIcon,{size:"lg",onClick:y,color:"green",children:(0,s.jsx)(G,{size:18})})})]}),(0,s.jsx)(w.Center,{children:(0,s.jsx)(P.TextInput,{placeholder:"搜索笔记名称",value:o,onChange:e=>d(e.currentTarget.value),size:"md",radius:"md",w:400,styles:{input:{textAlign:"center"}}})}),o&&0===$.length?(0,s.jsxs)(x.Stack,{align:"center",justify:"center",h:200,children:[(0,s.jsx)(i.Text,{size:"lg",c:"dimmed",children:"未找到笔记"}),(0,s.jsx)(i.Text,{size:"sm",c:"dimmed",children:"尝试用其他关键词搜索"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.Grid,{gutter:"md",children:ee.map(e=>(0,s.jsx)(N.Grid.Col,{span:{base:12,xs:6,sm:4,md:3,lg:3,xl:2},children:(0,s.jsx)(E.Card,{radius:"md",withBorder:!0,children:(0,s.jsxs)(u.Group,{justify:"space-between",wrap:"nowrap",gap:2,children:[(0,s.jsx)(i.Text,{fw:500,lineClamp:1,component:c(),href:Z(e),children:e.name}),(0,s.jsxs)(F.Menu,{shadow:"md",width:120,children:[(0,s.jsx)(F.Menu.Target,{children:(0,s.jsx)(m.ActionIcon,{variant:"subtle",color:"gary",children:(0,s.jsx)(W,{size:14})})}),(0,s.jsxs)(F.Menu.Dropdown,{children:[(0,s.jsx)(F.Menu.Item,{leftSection:(0,s.jsx)("span",{children:"\uD83D\uDCD6"}),onClick:()=>(e=>{let t=Z(e);window.open(t)})(e),children:"打开"}),(0,s.jsx)(F.Menu.Item,{leftSection:(0,s.jsx)("span",{children:"\uD83D\uDCE4"}),onClick:()=>(e=>{let t=Z(e);navigator.share?navigator.share({title:"笔记: ".concat(e.name),url:t}):navigator.clipboard.writeText(t).then(()=>{g.notifications.show({color:"green",message:"分享链接已复制到剪贴板"})})})(e),children:"分享"}),(0,s.jsx)(F.Menu.Item,{leftSection:(0,s.jsx)("span",{children:"✏️"}),onClick:()=>{_(e),J(e.name),Q(""),O()},children:"重命名"}),(0,s.jsx)(F.Menu.Divider,{}),(0,s.jsx)(F.Menu.Item,{leftSection:(0,s.jsx)("span",{children:"\uD83D\uDDD1️"}),onClick:()=>ea(e),children:"删除"})]})]})]})})},e.name))}),et&&(0,s.jsx)(w.Center,{children:(0,s.jsxs)(k.Button,{variant:"light",onClick:()=>{f(e=>e+100)},size:"md",children:["继续加载 (",$.length-h," 个剩余)"]})})]})]}):(0,s.jsxs)(x.Stack,{align:"center",justify:"center",h:200,children:[(0,s.jsx)(i.Text,{size:"lg",c:"dimmed",children:a?"正在加载":"暂无笔记"}),(0,s.jsxs)(u.Group,{children:[(0,s.jsx)(m.ActionIcon,{size:"lg",onClick:en,color:"blue",children:(0,s.jsx)(H.A,{size:18})}),(0,s.jsx)(m.ActionIcon,{size:"lg",onClick:y,color:"green",children:(0,s.jsx)(G,{size:18})})]})]}),(0,s.jsx)(b.Modal,{opened:v,onClose:ei,title:"创建新笔记",centered:!0,children:(0,s.jsxs)(x.Stack,{gap:"md",children:[(0,s.jsx)(P.TextInput,{placeholder:"请输入笔记名称",value:A,onChange:e=>{I(e.currentTarget.value),M("")},error:T,autoFocus:!0}),(0,s.jsxs)(u.Group,{justify:"flex-end",children:[(0,s.jsx)(k.Button,{variant:"default",onClick:ei,children:"取消"}),(0,s.jsx)(k.Button,{loading:D,onClick:es,children:"创建"})]})]})}),(0,s.jsx)(b.Modal,{opened:L,onClose:er,title:"重命名笔记",centered:!0,children:(0,s.jsxs)(x.Stack,{gap:"md",children:[(0,s.jsx)(P.TextInput,{placeholder:"请输入新的笔记名称",value:q,onChange:e=>{J(e.currentTarget.value),Q("")},error:K,autoFocus:!0}),(0,s.jsxs)(u.Group,{justify:"flex-end",children:[(0,s.jsx)(k.Button,{variant:"default",onClick:er,children:"取消"}),(0,s.jsx)(k.Button,{loading:V,onClick:el,children:"确认"})]})]})})]}):(0,s.jsx)(w.Center,{children:(0,s.jsx)(k.Button,{variant:"gradient",component:c(),href:"/login",children:"去登录"})})}let O=JSON.parse('["没有调查，就没有发言权","我为人人，人人为我","具体问题，具体分析","实践是检验真理的唯一标准","从最坏处着眼，往最好处努力","见微知著","读史以明志，鉴往而知来","爱的本质是付出","团结 紧张 严肃 活泼","出发就能到达","没说不行就是可以","真正的勇士敢于直面惨淡的人生和淋漓的鲜血","君子用人如器，各取所长","合抱之木，生于毫末","九层之台，起于累土","千里之行，始于足下","出发就能到达","人生的最高法则是什么:斗争","广厦千间，夜眠仅需六尺","家财万贯，日食不过三餐","碌碌百载，终归仅需寸土","芸芸众生，遍寻不过一人","把事情变简单","凡夫畏果，菩萨畏因","光灿烂时，星已死灭","聪明是一种天赋，而善良是一种选择","你打你的，我打我的","以斗争求和平则和平存，以妥协求和平则和平亡","抓住主要矛盾不放手"]');function U(){let[e,t]=(0,l.useState)("");return(0,l.useEffect)(()=>{let e=Math.floor(Math.random()*O.length);t(O[e])},[]),(0,s.jsx)(i.Text,{children:e})}function Y(){let[e,t]=(0,l.useState)(null);return(0,l.useEffect)(()=>{t(localStorage.getItem("homeTab")||"disk")},[]),(0,s.jsxs)(a.Tabs,{id:"page-home",variant:"pills",radius:0,value:e,onChange:e=>{t(e),localStorage.setItem("homeTab",e||"disk")},children:[(0,s.jsx)(a.Tabs.Panel,{keepMounted:!0,value:"disk",children:(0,s.jsx)(z,{})}),(0,s.jsx)(a.Tabs.Panel,{keepMounted:!0,value:"note",children:(0,s.jsx)(L,{})}),(0,s.jsx)(a.Tabs.Panel,{keepMounted:!0,value:"explore",children:(0,s.jsx)(U,{})}),(0,s.jsx)(a.Tabs.Panel,{keepMounted:!0,value:"mine",children:(0,s.jsx)(f,{})}),(0,s.jsxs)(a.Tabs.List,{children:[(0,s.jsxs)(a.Tabs.Tab,{value:"disk",children:[(0,s.jsx)(r.I,{name:"disk"===e?"ChatActive":"Chat"}),(0,s.jsx)(i.Text,{children:"网盘"})]}),(0,s.jsxs)(a.Tabs.Tab,{value:"note",children:[(0,s.jsx)(r.I,{name:"note"===e?"NoteActive":"Note"}),(0,s.jsx)(i.Text,{children:"笔记"})]}),(0,s.jsxs)(a.Tabs.Tab,{value:"explore",children:[(0,s.jsx)(r.I,{name:"explore"===e?"ExploreActive":"Explore"}),(0,s.jsx)(i.Text,{children:"探索"})]}),(0,s.jsxs)(a.Tabs.Tab,{value:"mine",children:[(0,s.jsx)(r.I,{name:"mine"===e?"MineActive":"Mine"}),(0,s.jsx)(i.Text,{children:"我的"})]})]})]})}n(44017)},4673:(e,t,n)=>{"use strict";n.d(t,{BP:()=>h,OM:()=>x,yO:()=>m});var s=n(30167),l=n(71425),a=n(44532),i=n(87788),r=n(56076),o=n(88413),c=n(70358),d=n(26634),u=n.n(d);let h=(e,t,n)=>{let c=(0,s.YW)(t),d=(0,s.YW)("/most.box/"+e),h=(0,l.A)(c,d,3,32,"sha512"),m=(0,a.q5)((0,i.s)(h)),x=m.slice(0,32),g=u().box.keyPair.fromSecretKey(x),p=(0,a.c$)(g.publicKey),j=(0,a.c$)(g.secretKey),f=r.v.entropyToPhrase(m);return{username:e,address:o.QX.fromPhrase(f).address,public_key:p,private_key:j,mnemonic:"I know loss mnemonic will lose my wallet."===n?f:""}},m=(e,t,n)=>{let s=new TextEncoder().encode(e),l=u().randomBytes(u().box.nonceLength),i=u().box(s,l,new Uint8Array((0,a.q5)(t)),new Uint8Array((0,a.q5)(n)));return i?["mp://2",(0,c.W)(l),(0,c.W)(i)].join("."):(console.info("加密失败"),"")},x=(e,t,n)=>{let[s,l,i]=e.split(".");if("mp://2"!==s)return console.info("无效的密文"),"";let r=u().box.open((0,c.y)(i),(0,c.y)(l),new Uint8Array((0,a.q5)(t)),new Uint8Array((0,a.q5)(n)));return r?new TextDecoder().decode(r):(console.info("解密失败"),"")}},6396:()=>{},9482:(e,t,n)=>{"use strict";n.d(t,{A:()=>k});var s=n(70358),l=n(30167),a=n(88413),i=n(19396),r=n(96842),o=n(42995),c=n(3648),d=n(4673),u=n(59909),h=n(30832),m=n.n(h),x=n(99758),g=n.n(x);n(38464);var p=n(76920),j=n.n(p);m().extend(j()),m().extend(g()),m().locale("zh-cn");let f=e=>{let t=String(Date.now()),n=(0,s.W)(crypto.getRandomValues(new Uint8Array(32))),l=sessionStorage.getItem("fingerprint")||"",a=[location.origin,l].join("/"),i=[t,n].join("."),{public_key:r,private_key:o}=(0,d.BP)(a,i);return{jwt:(0,d.yO)(JSON.stringify(e),r,o),jwtSecret:i}},v=(e,t)=>{let[n]=t.split(".");if(Date.now()-Number(n)>288e5)return console.log("jwt 已过期"),null;try{let n=sessionStorage.getItem("fingerprint")||"",s=[location.origin,n].join("/"),{public_key:l,private_key:a}=(0,d.BP)(s,t),i=(0,d.OM)(e,l,a);if(i)return JSON.parse(i)}catch(e){console.log("验证失败:",e)}return null},w=async e=>{let t=Date.now().toString(),n=a.QX.fromPhrase(e.mnemonic),s=await n.signMessage(t);localStorage.token=[e.address,t,s].join(".")},k={avatar:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Most";return(0,r.gn)(o,{seed:"most.box@"+e,flip:!0,backgroundType:["gradientLinear"]}).toDataUri()},avatarCID:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Most";return(0,r.gn)(c,{seed:"most.box#"+e,flip:!0,backgroundType:["gradientLinear","solid"]}).toDataUri()},formatTime:e=>{let t;if(!e)return"";let n=m()(Number(e)),s=n.hour();return t=s>=0&&s<3?"凌晨":s>=3&&s<6?"拂晓":s>=6&&s<9?"早晨":s>=9&&s<12?"上午":s>=12&&s<15?"下午":s>=15&&s<18?"傍晚":s>=18&&s<21?"薄暮":"深夜",n.format("YYYY年M月D日 ".concat(t,"h点m分"))},formatDate:e=>{let t=m()(Number(e)),n=m()();return t.isSame(n,"day")?t.format("HH:mm"):t.isSame(n.subtract(1,"day"),"day")?"昨天 ".concat(t.format("HH:mm")):t.isoWeek()===n.isoWeek()?"".concat(["周日","周一","周二","周三","周四","周五","周六"][t.day()]," ").concat(t.format("HH:mm")):t.year()===n.year()?t.format("M月D日"):t.format("YY年M月D日")},formatAddress:e=>e?e.slice(0,6)+"..."+e.slice(-4):"",enBase64:e=>(0,s.W)((0,l.YW)(e)),deBase64:e=>(0,l._v)((0,s.y)(e)),createJWT:f,verifyJWT:v,login:(e,t)=>{try{var n;let s=(0,d.BP)(e,t,"I know loss mnemonic will lose my wallet."),{jwt:l,jwtSecret:a}=f(s);if((null==(n=v(l,a))?void 0:n.address)===s.address)return localStorage.setItem("jwt",l),localStorage.setItem("jwtSecret",a),w(s),s}catch(e){console.log("登录失败:",e)}return null},ZeroAddress:i.j,createToken:w,pinyin:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(t.length<n)return!1;if(e.toLowerCase().includes(t.toLowerCase()))return!0;let s=(0,u.YW)(e,t,{continuous:!0});return!!s&&!!(s.length>=n)}}},29439:()=>{},41698:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86467).A)("outline","refresh","Refresh",[["path",{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4",key:"svg-0"}],["path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4",key:"svg-1"}]])},44017:()=>{},48764:(e,t,n)=>{"use strict";n.d(t,{k:()=>r});var s=n(9482),l=n(65453),a=n(54205),i=n(6942);let r=(0,l.v)((e,t)=>({wallet:void 0,initWallet(){let n=localStorage.getItem("jwt"),l=localStorage.getItem("jwtSecret");if(n&&l){let a=s.A.verifyJWT(n,l);a?(s.A.createToken(a),e({wallet:a})):t().exit()}},async updateDot(t){let n=new URL(t).origin;try{let t=(await a.FH.get(n+"/api.dot",{timeout:3e3})).data;a.FH.defaults.baseURL=n,e({dotAPI:n}),localStorage.setItem("dotAPI",n);let s=t.CIDs[0];return n.endsWith(":1976")&&(s=n.slice(0,-5)+":8080"),s&&(e({dotCID:s}),localStorage.setItem("dotCID",s)),e({notes:void 0,files:void 0}),t.APIs}catch(t){i.notifications.show({title:"节点切换失败",message:n,color:"red"}),console.error(t),e({dotAPI:a.FH.defaults.baseURL||""})}return null},setItem:(t,n)=>e(e=>({...e,[t]:n})),firstPath:"",dotAPI:a.MN,dotCID:a.AF,dotNodes:[],notes:void 0,files:void 0,exit(){e({wallet:void 0,notes:void 0,files:void 0}),localStorage.removeItem("jwt"),localStorage.removeItem("jwtSecret"),localStorage.removeItem("token")}}))},54205:(e,t,n)=>{"use strict";n.d(t,{AF:()=>a,C2:()=>i,FH:()=>r,MN:()=>l});var s=n(23464);let l="https://dot.most.red",a="https://cid.most.red",i="https://most.box/auth/callback",r=s.A.create({baseURL:l});r.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization=t),e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e,e=>("ERR_NETWORK"===e.code&&(window.location.href="/dot"),Promise.reject(e)))},54395:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86467).A)("outline","x","X",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]])},65453:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});var s=n(12115);let l=e=>{let t,n=new Set,s=(e,s)=>{let l="function"==typeof e?e(t):e;if(!Object.is(l,t)){let e=t;t=(null!=s?s:"object"!=typeof l||null===l)?l:Object.assign({},t,l),n.forEach(n=>n(t,e))}},l=()=>t,a={setState:s,getState:l,getInitialState:()=>i,subscribe:e=>(n.add(e),()=>n.delete(e))},i=t=e(s,l,a);return a},a=e=>{let t=(e=>e?l(e):l)(e),n=e=>(function(e,t=e=>e){let n=s.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return s.useDebugValue(n),n})(t,e);return Object.assign(n,t),n},i=e=>e?a(e):a},71281:()=>{},83572:()=>{},86467:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var s=n(12115),l={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}};let a=(e,t,n,a)=>{let i=(0,s.forwardRef)((n,i)=>{let{color:r="currentColor",size:o=24,stroke:c=2,title:d,className:u,children:h,...m}=n;return(0,s.createElement)("svg",{ref:i,...l[e],width:o,height:o,className:["tabler-icon","tabler-icon-".concat(t),u].join(" "),..."filled"===e?{fill:r}:{strokeWidth:c,stroke:r},...m},[d&&(0,s.createElement)("title",{key:"svg-title"},d),...a.map(e=>{let[t,n]=e;return(0,s.createElement)(t,n)}),...Array.isArray(h)?h:[h]])});return i.displayName="".concat(n),i}},92826:(e,t,n)=>{Promise.resolve().then(n.bind(n,1072))},97237:()=>{}},e=>{e.O(0,[298,2545,8198,8887,9549,3819,8805,8636,2598,8694,3464,6305,7508,116,6874,42,8441,5881,7358],()=>e(e.s=92826)),_N_E=e.O()}]);