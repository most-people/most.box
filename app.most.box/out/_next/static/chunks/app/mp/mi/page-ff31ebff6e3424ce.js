(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6873],{577:(e,o,r)=>{Promise.resolve().then(r.bind(r,67512))},56612:(e,o,r)=>{"use strict";r.d(o,{BP:()=>w,OM:()=>u,yO:()=>m});var t=r(68110),i=r(330),s=r(16405),n=r(42779),a=r(10179),l=r(38798),c=r(43591),d=r(28555),h=r.n(d);let w=(e,o,r)=>{let c=(0,t.YW)(o),d=(0,t.YW)("/most.box/"+e),w=(0,i.A)(c,d,3,32,"sha512"),m=(0,s.q5)((0,n.s)(w)),u=m.slice(0,32),x=h().box.keyPair.fromSecretKey(u),g=(0,s.c$)(x.publicKey),f=(0,s.c$)(x.secretKey),p=a.v.entropyToPhrase(m);return{username:e,address:l.QX.fromPhrase(p).address,public_key:g,private_key:f,mnemonic:"I know loss mnemonic will lose my wallet."===r?p:""}},m=(e,o,r)=>{let t=new TextEncoder().encode(e),i=h().randomBytes(h().box.nonceLength),n=h().box(t,i,new Uint8Array((0,s.q5)(o)),new Uint8Array((0,s.q5)(r)));return n?["mp://2",(0,c.W)(i),(0,c.W)(n)].join("."):(console.info("加密失败"),"")},u=(e,o,r)=>{let[t,i,n]=e.split(".");if("mp://2"!==t)return console.info("无效协议"),"";let a=h().box.open((0,c.y)(n),(0,c.y)(i),new Uint8Array((0,s.q5)(o)),new Uint8Array((0,s.q5)(r)));return a?new TextDecoder().decode(a):(console.info("无法解密"),"")}},67512:(e,o,r)=>{"use strict";r.r(o),r.d(o,{default:()=>j});var t=r(95155),i=r(90101),s=r(13877),n=r(2369),a=r(41970),l=r(67623),c=r(70305),d=r(27701),h=r(92364),w=r(67661),m=r(96778),u=r(12115),x=r(56612),g=r(59126),f=r(67812),p=r(73351),y=r(26195),b=r(31064);function j(){let[e,o]=(0,u.useState)(""),[r,j]=(0,u.useState)(""),[v,k]=(0,u.useState)(""),[T,{toggle:B}]=(0,b.useDisclosure)(!0),C="most.box/mp/mi",P=async()=>{if(!r.trim())return void g.notifications.show({message:"没有可复制的明文内容",color:"orange"});try{await navigator.clipboard.writeText(r),g.notifications.show({title:"成功",message:"明文已复制到剪贴板",color:"green"})}catch(e){console.error(e)}},A=async()=>{let e=new URL(window.location.origin+window.location.pathname);e.searchParams.set("mi",v);let o=e.href;try{navigator.share?await navigator.share({title:"加密信息分享",text:o,url:o}):(await navigator.clipboard.writeText(o),g.notifications.show({title:"成功",message:"分享链接已复制到剪贴板",color:"green"}))}catch(e){console.error(e)}};return(0,u.useEffect)(()=>{let e=new URL(window.location.href).searchParams.get("mi");e&&k(e)},[]),(0,t.jsxs)(s.Container,{maw:600,w:"100%",children:[(0,t.jsx)(i.AppHeader,{title:"加密 / 解密"}),(0,t.jsxs)(n.Stack,{gap:"md",mt:"md",children:[(0,t.jsx)(a.Alert,{icon:(0,t.jsx)(f.A,{size:16}),children:"使用 X25519 加密算法对文本进行加密和解密"}),(0,t.jsxs)(l.Box,{children:[(0,t.jsx)(c.Text,{size:"sm",fw:500,mb:5,children:"密码"}),(0,t.jsx)(d.PasswordInput,{autoFocus:!0,placeholder:"请输入密码",visible:T,onVisibilityChange:B,value:e,onChange:e=>o(e.currentTarget.value)})]}),(0,t.jsxs)(l.Box,{children:[(0,t.jsx)(c.Text,{size:"sm",fw:500,mb:5,children:"密文"}),(0,t.jsx)(h.Textarea,{placeholder:"加密后的文本将显示在这里",value:v,onChange:e=>k(e.currentTarget.value),minRows:4,autosize:!0})]}),(0,t.jsxs)(w.Group,{grow:!0,children:[(0,t.jsx)(m.Button,{onClick:()=>{if(!e.trim())return void g.notifications.show({message:"请输入密码",color:"orange"});try{let o=(0,x.BP)(C,e),r=(0,x.OM)(v,o.public_key,o.private_key);r?(j(r),g.notifications.show({title:"成功",message:"解密完成",color:"green"})):g.notifications.show({title:"错误",message:"解密失败，请检查密码或密文是否正确",color:"red"})}catch(e){console.error(e),g.notifications.show({title:"错误",message:"解密过程中发生错误",color:"red"})}},disabled:!v,children:"解密"}),(0,t.jsx)(m.Button,{variant:"light",color:"blue",onClick:A,disabled:!v,leftSection:(0,t.jsx)(p.A,{size:16}),children:"分享"})]}),(0,t.jsxs)(l.Box,{children:[(0,t.jsx)(c.Text,{size:"sm",fw:500,mb:5,children:"明文"}),(0,t.jsx)(h.Textarea,{placeholder:"请输入要加密的文本",value:r,onChange:e=>j(e.currentTarget.value),minRows:4,autosize:!0})]}),(0,t.jsxs)(w.Group,{grow:!0,children:[(0,t.jsx)(m.Button,{onClick:()=>{if(!e.trim())return void g.notifications.show({message:"请输入密码",color:"orange"});try{let o=(0,x.BP)(C,e),t=(0,x.yO)(r,o.public_key,o.private_key);if(t){k(t);let e=new URL(window.location.href);e.searchParams.set("mi",t),window.history.replaceState({},"",e.href),g.notifications.show({title:"成功",message:"加密完成",color:"green"})}else g.notifications.show({title:"错误",message:"加密失败",color:"red"})}catch(e){console.error(e),g.notifications.show({title:"错误",message:"加密过程中发生错误",color:"red"})}},disabled:!r,color:"orange",children:"加密"}),(0,t.jsx)(m.Button,{variant:"light",color:"green",onClick:P,disabled:!r.trim(),leftSection:(0,t.jsx)(y.A,{size:16}),children:"复制"})]})]})]})}},71281:()=>{}},e=>{e.O(0,[2829,5619,6714,8555,9287,9250,101,8441,1255,7358],()=>e(e.s=577)),_N_E=e.O()}]);