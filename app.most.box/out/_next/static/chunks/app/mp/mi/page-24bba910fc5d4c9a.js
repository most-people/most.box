(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6873],{4673:(e,o,t)=>{"use strict";t.d(o,{BP:()=>m,OM:()=>u,yO:()=>w});var r=t(30167),s=t(71425),i=t(44532),n=t(87788),a=t(56076),l=t(88413),c=t(70358),h=t(26634),d=t.n(h);let m=(e,o,t)=>{let c=(0,r.YW)(o),h=(0,r.YW)("/most.box/"+e),m=(0,s.A)(c,h,3,32,"sha512"),w=(0,i.q5)((0,n.s)(m)),u=w.slice(0,32),x=d().box.keyPair.fromSecretKey(u),g=(0,i.c$)(x.publicKey),f=(0,i.c$)(x.secretKey),p=a.v.entropyToPhrase(w);return{username:e,address:l.QX.fromPhrase(p).address,public_key:g,private_key:f,mnemonic:"I know loss mnemonic will lose my wallet."===t?p:""}},w=(e,o,t)=>{let r=new TextEncoder().encode(e),s=d().randomBytes(d().box.nonceLength),n=d().box(r,s,new Uint8Array((0,i.q5)(o)),new Uint8Array((0,i.q5)(t)));return n?["mp://2",(0,c.W)(s),(0,c.W)(n)].join("."):(console.info("加密失败"),"")},u=(e,o,t)=>{let[r,s,n]=e.split(".");if("mp://2"!==r)return console.info("无效协议"),"";let a=d().box.open((0,c.y)(n),(0,c.y)(s),new Uint8Array((0,i.q5)(o)),new Uint8Array((0,i.q5)(t)));return a?new TextDecoder().decode(a):(console.info("解密失败"),"")}},60599:(e,o,t)=>{"use strict";t.r(o),t.d(o,{default:()=>j});var r=t(95155),s=t(80630),i=t(91590),n=t(21220),a=t(74634),l=t(69604),c=t(58887),h=t(25345),d=t(41954),m=t(70112),w=t(26903),u=t(12115),x=t(4673),g=t(6942),f=t(17187),p=t(36898),y=t(53884),b=t(11681);function j(){let[e,o]=(0,u.useState)(""),[t,j]=(0,u.useState)(""),[v,k]=(0,u.useState)(""),[T,{toggle:B}]=(0,b.useDisclosure)(!0),C="most.box/mp/mi",P=async()=>{if(!t.trim())return void g.notifications.show({message:"没有可复制的明文内容",color:"orange"});try{await navigator.clipboard.writeText(t),g.notifications.show({title:"成功",message:"明文已复制到剪贴板",color:"green"})}catch(e){console.error(e)}},A=async()=>{let e=new URL("https://most.box"+window.location.pathname);e.searchParams.set("mi",v);let o=e.href;try{navigator.share?await navigator.share({title:"加密信息分享",text:o,url:o}):(await navigator.clipboard.writeText(o),g.notifications.show({title:"成功",message:"分享链接已复制到剪贴板",color:"green"}))}catch(e){console.error(e)}};return(0,u.useEffect)(()=>{let e=new URL(window.location.href).searchParams.get("mi");e&&k(e)},[]),(0,r.jsxs)(i.Container,{maw:600,w:"100%",children:[(0,r.jsx)(s.AppHeader,{title:"加密 / 解密"}),(0,r.jsxs)(n.Stack,{gap:"md",mt:"md",children:[(0,r.jsx)(a.Alert,{icon:(0,r.jsx)(f.A,{size:16}),children:"使用 X25519 加密算法对文本进行加密和解密"}),(0,r.jsxs)(l.Box,{children:[(0,r.jsx)(c.Text,{size:"sm",fw:500,mb:5,children:"密码"}),(0,r.jsx)(h.PasswordInput,{autoFocus:!0,placeholder:"请输入密码",visible:T,onVisibilityChange:B,value:e,onChange:e=>o(e.currentTarget.value)})]}),(0,r.jsxs)(l.Box,{children:[(0,r.jsx)(c.Text,{size:"sm",fw:500,mb:5,children:"密文"}),(0,r.jsx)(d.Textarea,{placeholder:"加密后的文本将显示在这里",value:v,onChange:e=>k(e.currentTarget.value),minRows:4,autosize:!0})]}),(0,r.jsxs)(m.Group,{grow:!0,children:[(0,r.jsx)(w.Button,{onClick:()=>{if(!e.trim())return void g.notifications.show({message:"请输入密码",color:"orange"});try{let o=(0,x.BP)(C,e),t=(0,x.OM)(v,o.public_key,o.private_key);t?(j(t),g.notifications.show({title:"成功",message:"解密完成",color:"green"})):g.notifications.show({title:"错误",message:"解密失败，请检查密码或密文是否正确",color:"red"})}catch(e){console.error(e),g.notifications.show({title:"错误",message:"解密过程中发生错误",color:"red"})}},disabled:!v,children:"解密"}),(0,r.jsx)(w.Button,{variant:"light",color:"blue",onClick:A,disabled:!v,leftSection:(0,r.jsx)(p.A,{size:16}),children:"分享"})]}),(0,r.jsxs)(l.Box,{children:[(0,r.jsx)(c.Text,{size:"sm",fw:500,mb:5,children:"明文"}),(0,r.jsx)(d.Textarea,{placeholder:"请输入要加密的文本",value:t,onChange:e=>j(e.currentTarget.value),minRows:4,autosize:!0})]}),(0,r.jsxs)(m.Group,{grow:!0,children:[(0,r.jsx)(w.Button,{onClick:()=>{if(!e.trim())return void g.notifications.show({message:"请输入密码",color:"orange"});try{let o=(0,x.BP)(C,e),r=(0,x.yO)(t,o.public_key,o.private_key);if(r){k(r);let e=new URL(window.location.href);e.searchParams.set("mi",r),window.history.replaceState({},"",e.href),g.notifications.show({title:"成功",message:"加密完成",color:"green"})}else g.notifications.show({title:"错误",message:"加密失败",color:"red"})}catch(e){console.error(e),g.notifications.show({title:"错误",message:"加密过程中发生错误",color:"red"})}},disabled:!t,color:"orange",children:"加密"}),(0,r.jsx)(w.Button,{variant:"light",color:"green",onClick:P,disabled:!t.trim(),leftSection:(0,r.jsx)(y.A,{size:16}),children:"复制"})]})]})]})}},71281:()=>{},73457:(e,o,t)=>{Promise.resolve().then(t.bind(t,60599))}},e=>{e.O(0,[1257,8805,8413,6634,4956,5232,630,8441,5964,7358],()=>e(e.s=73457)),_N_E=e.O()}]);