(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6769],{20063:(e,t,r)=>{"use strict";var a=r(47260);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},24107:(e,t,r)=>{"use strict";r.d(t,{isElement:()=>s});var a=r(12115);function s(e){return!Array.isArray(e)&&null!==e&&"object"==typeof e&&e.type!==a.Fragment}},26442:(e,t,r)=>{"use strict";r.d(t,{useHash:()=>o});var a=r(12115),s=r(25528);function o(){let{getInitialValueInEffect:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,r]=(0,a.useState)(e?"":window.location.hash||"");return(0,s.useWindowEvent)("hashchange",()=>{let e=window.location.hash;t!==e&&r(e)}),(0,a.useEffect)(()=>{e&&r(window.location.hash)},[]),[t,e=>{let t=e.startsWith("#")?e:"#".concat(e);window.location.hash=t,r(t)}]}},41970:(e,t,r)=>{"use strict";r.d(t,{Alert:()=>f});var a=r(95155),s=r(8893);r(12115);var o=r(49957),n=r(80533),l=r(23653),i=r(39398),c=r(67623),u=r(91853),d=r(76167),h={root:"m_66836ed3",wrapper:"m_a5d60502",body:"m_667c2793",title:"m_6a03f287",label:"m_698f4f23",icon:"m_667f2a6a",message:"m_7fa78076",closeButton:"m_87f54839"};let m=(0,n.createVarsResolver)((e,t)=>{let{radius:r,color:a,variant:s,autoContrast:n}=t,l=e.variantColorResolver({color:a||e.primaryColor,theme:e,variant:s||"light",autoContrast:n});return{root:{"--alert-radius":void 0===r?void 0:(0,o.getRadius)(r),"--alert-bg":a||s?l.background:void 0,"--alert-color":l.color,"--alert-bd":a||s?l.border:void 0}}}),f=(0,u.factory)((e,t)=>{let r=(0,l.useProps)("Alert",null,e),{classNames:o,className:n,style:u,styles:f,unstyled:p,vars:v,radius:y,color:b,title:g,children:j,id:x,icon:w,withCloseButton:P,onClose:S,closeButtonLabel:C,variant:_,autoContrast:k,attributes:A,...E}=r,N=(0,i.useStyles)({name:"Alert",classes:h,props:r,className:n,style:u,classNames:o,styles:f,unstyled:p,attributes:A,vars:v,varsResolver:m}),R=(0,s.useId)(x),O=g&&"".concat(R,"-title")||void 0,B="".concat(R,"-body");return(0,a.jsx)(c.Box,{id:R,...N("root",{variant:_}),variant:_,ref:t,...E,role:"alert","aria-describedby":B,"aria-labelledby":O,children:(0,a.jsxs)("div",{...N("wrapper"),children:[w&&(0,a.jsx)("div",{...N("icon"),children:w}),(0,a.jsxs)("div",{...N("body"),children:[g&&(0,a.jsx)("div",{...N("title"),"data-with-close-button":P||void 0,children:(0,a.jsx)("span",{id:O,...N("label"),children:g})}),j&&(0,a.jsx)("div",{id:B,...N("message"),"data-variant":_,children:j})]}),P&&(0,a.jsx)(d.CloseButton,{...N("closeButton"),onClick:S,variant:"transparent",size:16,iconSize:16,"aria-label":C,unstyled:p})]})})});f.classes=h,f.displayName="@mantine/core/Alert"},63790:(e,t,r)=>{"use strict";r.d(t,{Portal:()=>h});var a=r(95155),s=r(12115),o=r(47650),n=r(98200),l=r(11286),i=r(23653),c=r(91853);function u(e){let t=document.createElement("div");return t.setAttribute("data-portal","true"),"string"==typeof e.className&&t.classList.add(...e.className.split(" ").filter(Boolean)),"object"==typeof e.style&&Object.assign(t.style,e.style),"string"==typeof e.id&&t.setAttribute("id",e.id),t}let d={reuseTargetNode:!0},h=(0,c.factory)((e,t)=>{let{children:r,target:c,reuseTargetNode:h,...m}=(0,i.useProps)("Portal",d,e),[f,p]=(0,s.useState)(!1),v=(0,s.useRef)(null);return((0,n.useIsomorphicEffect)(()=>(p(!0),v.current=function(e){let{target:t,reuseTargetNode:r,...a}=e;if(t)return"string"==typeof t?document.querySelector(t)||u(a):t;if(r){let e=document.querySelector("[data-mantine-shared-portal-node]");if(e)return e;let t=u(a);return t.setAttribute("data-mantine-shared-portal-node","true"),document.body.appendChild(t),t}return u(a)}({target:c,reuseTargetNode:h,...m}),(0,l.assignRef)(t,v.current),c||h||!v.current||document.body.appendChild(v.current),()=>{c||h||!v.current||document.body.removeChild(v.current)}),[c]),f&&v.current)?(0,o.createPortal)((0,a.jsx)(a.Fragment,{children:r}),v.current):null});h.displayName="@mantine/core/Portal"},71706:(e,t,r)=>{"use strict";r.d(t,{OptionalPortal:()=>l});var a=r(95155);r(12115);var s=r(98865),o=r(91853),n=r(63790);let l=(0,o.factory)((e,t)=>{let{withinPortal:r=!0,children:o,...l}=e;return"test"!==(0,s.useMantineEnv)()&&r?(0,a.jsx)(n.Portal,{ref:t,...l,children:o}):(0,a.jsx)(a.Fragment,{children:o})});l.displayName="@mantine/core/OptionalPortal"},83177:(e,t,r)=>{Promise.resolve().then(r.bind(r,87756))},87756:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var a=r(95155),s=r(12115),o=r(20063),n=r(13877),l=r(2369),i=r(63090),c=r(70305),u=r(90632),d=r(41970),h=r(27701),m=r(67661),f=r(96778),p=r(8620),v=r(97443),y=r(13297),b=r(26442),g=r(31064),j=r(59126);function x(){let e=(0,o.useRouter)(),t=(0,y.k)(e=>e.setWallet),[r]=(0,b.useHash)(),[x,{toggle:w}]=(0,g.useDisclosure)(!1),[P,S]=(0,s.useState)(""),[C,_]=(0,s.useState)(!1),[k,A]=(0,s.useState)(""),[E,N]=(0,s.useState)(""),[R,O]=(0,s.useState)(null),B=(r,a)=>{let s=r.email||r.id.slice(-6),o=[r.created_at,r.id,"most.box!"+a].join("|"),n=v.A.login(s,o);n&&setTimeout(()=>{t(n)},0),e.replace("/")},I=async()=>{try{var t;let{data:r,error:a}=await p.N.auth.getSession();if(a)return void console.error("Auth callback error:",a);let s=null==(t=r.session)?void 0:t.user;s?(p.N.auth.signOut(),O(s),P?B(s,P):_(!0)):e.push("/login")}catch(e){console.error("Get session error:",e)}};return(0,s.useEffect)(()=>{I()},[]),(0,s.useEffect)(()=>{if(r){let e=new URLSearchParams(r.slice(1));e.get("error")&&(console.error("Auth callback error:",r),j.notifications.show({color:"red",title:e.get("error"),message:e.get("error_description")}))}},[r]),(0,a.jsxs)(n.Container,{children:[(0,a.jsxs)(l.Stack,{align:"center",children:[(0,a.jsx)(i.Loader,{size:"lg"}),(0,a.jsx)(c.Text,{children:"正在处理登录..."})]}),(0,a.jsx)(u.Modal,{opened:C,onClose:()=>{},closeOnClickOutside:!1,closeOnEscape:!1,withCloseButton:!1,centered:!0,children:(0,a.jsxs)(l.Stack,{children:[(0,a.jsx)(d.Alert,{children:"为了确保资金安全，即使社交账户被盗也能保护您的资产。"}),(0,a.jsx)(h.PasswordInput,{placeholder:"建议您设置密码",visible:x,onVisibilityChange:w,value:k,onChange:e=>{A(e.currentTarget.value),N("")},error:E}),(0,a.jsxs)(m.Group,{justify:"space-between",children:[(0,a.jsx)(f.Button,{variant:"outline",onClick:()=>{_(!1),R&&B(R,"")},children:"不设置密码"}),(0,a.jsx)(f.Button,{onClick:()=>{if(!k)return void N("请输入密码");S(k),_(!1),R&&B(R,k)},children:"设置密码"})]})]})})]})}},94419:(e,t,r)=>{"use strict";r.d(t,{getDefaultZIndex:()=>s});let a={app:100,modal:200,popover:300,overlay:400,max:9999};function s(e){return a[e]}}},e=>{e.O(0,[8198,2545,2794,5619,6714,8555,8835,5125,6476,9287,3584,5595,380,9032,8760,1636,8441,1255,7358],()=>e(e.s=83177)),_N_E=e.O()}]);