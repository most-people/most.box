(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8457],{38639:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n="IPv6 (Internet Protocol version 6) 是下一代互联网的核心协议，旨在解决 IPv4 地址枯竭问题并提升网络性能。\r\n\r\n**核心功能：每个设备可拥有全球唯一公网 IP，消除对 NAT 的依赖，回归端到端通信。**\r\n\r\n- IPv4 的 32 位地址（约 43 亿个）已耗尽。IPv6 采用 128 位地址，提供近乎无限的地址空间，满足物联网、5G 等海量设备连接需求。\r\n\r\n- [test-ipv6.com](https://test-ipv6.com) | [itdog.cn](https://www.itdog.cn/localhost/) | [ipw.cn](https://ipw.cn) | [test6.ustc.edu.cn](https://test6.ustc.edu.cn) 可以测试当前网络是否支持 IPv6\r\n"},80262:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>M});var n=r(95155),a=r(90101),i=r(99682),o=r(21794),s=r(13877),l=r(2369),c=r(40387),d=r(67661),u=r(74264),h=r(17998),g=r(82726),f=r(60688),m=r(93852),p=r(9457),y=r(58380),w=r(96778),x=r(70305),j=r(21179),v=r(67623),b=r(92364),T=r(44634),S=r(59126),k=r(93027),C=r(64998),P=r(86804),R=r(99853),I=r(43643),D=r(15884),B=r(12115),A=r(38639),E=r(13297),z=r(61505),O=r(97443);function M(){var e;let[t,r]=(0,B.useState)(""),[M,Y]=(0,B.useState)("001"),[U,G]=(0,B.useState)(null),[H,W]=(0,B.useState)(!1),[L,N]=(0,B.useState)(!1),[V,_]=(0,B.useState)("new"),[F,J]=(0,B.useState)("new"),[K,q]=(0,B.useState)(null),[Q,X]=(0,B.useState)(!0),[Z,$]=(0,B.useState)(!1),[ee,et]=(0,B.useState)(!1),er=(0,B.useRef)(null),en=(0,B.useRef)(null),ea=(0,B.useRef)(null),ei=(0,B.useRef)(null),eo=(0,B.useRef)(null),es=(0,B.useRef)([]),el=(0,B.useRef)(null),ec=(0,B.useRef)(null),ed=(0,B.useRef)(null),[eu,eh]=(0,B.useState)(!1),[eg,ef]=(0,B.useState)([]),[em,ep]=(0,B.useState)("");(0,B.useEffect)(()=>{el.current=U},[U]),(0,B.useEffect)(()=>{if(!H||!en.current)return;let e=setInterval(()=>{let e=en.current;if(e){let t=e.connectionState,r=e.iceConnectionState;t!==V&&_(t),r!==F&&J(r);let n="connected"===t&&("connected"===r||"completed"===r);n!==L&&N(n)}},2e3);return()=>clearInterval(e)},[H,V,F,L]);let ey=e=>{let t=new URL(window.location.href);e!==t.searchParams.get("id")&&(t.searchParams.set("id",e),window.history.replaceState({},"",t.href))},ew=H?"已".concat(U?"".concat("creator"===U?"创建":"加入"):""):"未连接",ex=H?"green":"gray",ej=L?"P2P已连接":"P2P未连接",ev=L?"green":"connecting"===V?"yellow":"gray",eb=async e=>{if(e)try{await e.play()}catch(e){console.info("视频播放失败",e)}},eT=async(e,t)=>{eo.current=t,ea.current&&(ea.current.srcObject=t,await eb(ea.current)),t.getTracks().forEach(r=>e.addTrack(r,t));let r=t.getAudioTracks(),n=t.getVideoTracks();et(n.length>0),X(r.length>0&&r.every(e=>e.enabled)),$(n.length>0&&n.every(e=>e.enabled))},eS=async()=>{try{return await navigator.mediaDevices.getUserMedia({audio:!0,video:{width:640,height:360}})}catch(e){console.info("获取视频失败",e),S.notifications.show({message:"请检查摄像头权限",color:"orange"});try{return await navigator.mediaDevices.getUserMedia({audio:!0,video:!1})}catch(e){console.info("获取音频失败",e),S.notifications.show({message:"请检查麦克风权限",color:"orange"})}}},ek=async e=>{if(es.current.length)for(let t of es.current.splice(0))try{await e.addIceCandidate(new RTCIceCandidate(t))}catch(e){console.info("添加 ICE 候选失败",e)}},eC=async(e,t)=>{await e.setRemoteDescription(new RTCSessionDescription(t)),await ek(e)},eP=async(e,t)=>{try{e.remoteDescription?await e.addIceCandidate(new RTCIceCandidate(t)):es.current.push(t)}catch(e){console.info("添加 ICE 候选失败",e)}},eR=async e=>{try{await fetch("".concat(o.FH.getUri(),"/api.signaling"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(e){console.info("发送信号失败",e)}},eI=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];ef(n=>[...n,{id:Date.now()+Math.random(),from:e,text:t,ts:Date.now(),self:r}])},eD=e=>{ec.current=e,e.onopen=()=>{eh(!0),S.notifications.show({message:"文字通道已建立",color:"green"})},e.onmessage=e=>{eI("远端","string"==typeof e.data?e.data:"[非文本消息]",!1)},e.onclose=()=>{eh(!1),S.notifications.show({message:"文字通道已关闭",color:"orange"})},e.onerror=()=>{S.notifications.show({message:"文字通道出错",color:"red"})}},eB=()=>{let e=ec.current,t=em.trim();if(t){if(!e||"open"!==e.readyState)return void S.notifications.show({message:"通道未就绪，无法发送",color:"orange"});e.send(t),eI("本地",t,!0),ep("")}};(0,B.useEffect)(()=>{let e=ed.current;e&&(e.scrollTop=e.scrollHeight)},[eg]);let eA=async()=>{try{let e=await o.FH.get("/api.room",{params:{roomId:M}});if(e.data.ok)return e.data.users}catch(e){console.info("获取房间用户失败",e)}},eE=async()=>{let e=en.current;if(e)try{let t=await e.getStats(),r={};t.forEach(e=>{"candidate-pair"===e.type&&"succeeded"===e.state&&(r.candidatePair={bytesReceived:e.bytesReceived,bytesSent:e.bytesSent,currentRoundTripTime:e.currentRoundTripTime,availableOutgoingBitrate:e.availableOutgoingBitrate}),"inbound-rtp"===e.type&&"video"===e.mediaType&&(r.inboundVideo={bytesReceived:e.bytesReceived,packetsReceived:e.packetsReceived,packetsLost:e.packetsLost,framesDecoded:e.framesDecoded}),"outbound-rtp"===e.type&&"video"===e.mediaType&&(r.outboundVideo={bytesSent:e.bytesSent,packetsSent:e.packetsSent,framesEncoded:e.framesEncoded})}),q(r),console.log("连接统计信息:",r)}catch(e){console.error("获取连接统计失败:",e)}},ez=async()=>{let e=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun.nextcloud.com:443"},{urls:"stun:stun.freeswitch.org:3478"}]});e.oniceconnectionstatechange=()=>{let t=e.iceConnectionState;J(t),console.log("ICE 连接状态变化:",t),"connected"===t||"completed"===t?(N(!0),S.notifications.show({message:"P2P 连接已建立！",color:"green"})):("disconnected"===t||"failed"===t)&&(N(!1),"failed"===t&&S.notifications.show({message:"P2P 连接失败，请重试",color:"red"}))},e.onconnectionstatechange=()=>{let t=e.connectionState;_(t),console.log("连接状态变化:",t),"connected"===t?(N(!0),S.notifications.show({message:"WebRTC 连接已建立！",color:"green"})):"disconnected"===t||"failed"===t?(N(!1),"failed"===t&&S.notifications.show({message:"WebRTC 连接失败",color:"red"})):"connecting"===t&&S.notifications.show({message:"正在建立 P2P 连接...",color:"blue"})},e.onicecandidate=e=>{e.candidate&&eR({roomId:M,from:t,type:"candidate",payload:e.candidate})},e.ontrack=e=>{if(!ei.current)return;let[t]=e.streams;t&&(ei.current.srcObject=t,eb(ei.current))},e.ondatachannel=e=>{eD(e.channel)};let r=eo.current,n=r||await eS();if(n)if(r){ea.current&&!ea.current.srcObject&&(ea.current.srcObject=n,await eb(ea.current)),n.getTracks().forEach(t=>e.addTrack(t,n));let t=n.getAudioTracks(),r=n.getVideoTracks();et(r.length>0),X(t.length>0&&t.every(e=>e.enabled)),$(r.length>0&&r.every(e=>e.enabled))}else await eT(e,n);return en.current=e,e},eO=async()=>{try{let e=await eA();if(!e)return void S.notifications.show({message:"获取房间用户失败",color:"red"});if(e.length>=2)return void S.notifications.show({message:"房间已满，试试更换房间 ID",color:"red"});let r=0===e.length?"creator":"joiner";el.current=r,es.current=[],await ez(),G(r),er.current&&er.current.close();let n=new URL(o.FH.getUri());n.pathname="/sse.signaling",n.searchParams.append("roomId",M),n.searchParams.append("clientId",t);let a=new EventSource(n.href,{withCredentials:!1});if(a.onopen=()=>{var e;W(!0);let r=en.current;"joiner"===el.current&&(null==r||null==(e=r.localDescription)?void 0:e.type)==="offer"&&eR({roomId:M,from:t,type:"offer",payload:r.localDescription})},a.onerror=e=>{console.info("SSE 连接错误",e)},a.onmessage=async e=>{try{let r=JSON.parse(e.data);if(!r||!r.type||"hello"===r.type)return;if("join"===r.type)return void S.notifications.show({message:r.clientId+" 加入房间",color:"blue"});if("leave"===r.type){S.notifications.show({message:r.clientId+" 离开房间",color:"blue"}),"joiner"===el.current&&eM();return}let n=en.current;if(!n)return;if("offer"===r.type&&"creator"===el.current){await eC(n,r.payload);let e=await n.createAnswer();await n.setLocalDescription(e),await eR({roomId:M,from:t,type:"answer",payload:e})}else"answer"===r.type&&"joiner"===el.current?await eC(n,r.payload):"candidate"===r.type&&await eP(n,r.payload)}catch(e){console.info(e)}},er.current=a,"joiner"===r){let e=en.current,r=e.createDataChannel("chat",{ordered:!0});eD(r);let n=await e.createOffer();await e.setLocalDescription(n),await eR({roomId:M,from:t,type:"offer",payload:n})}}catch(e){console.info("连接失败",e)}},eM=async()=>{var e,t;if(null==(e=er.current)||e.close(),er.current=null,W(!1),G(null),N(!1),_("new"),J("new"),q(null),ec.current){try{ec.current.close()}catch(e){}ec.current=null}eh(!1);let r=en.current;r&&(r.getSenders().forEach(e=>{try{var t;null==(t=e.track)||t.stop()}catch(e){console.info("停止发送器失败",e)}}),r.onicecandidate=null,r.ontrack=null,r.ondatachannel=null,r.close(),en.current=null),null==(t=eo.current)||t.getTracks().forEach(e=>e.stop()),eo.current=null,es.current=[],et(!1),X(!1),$(!1)},eY=(0,z.B)(),eU=(0,B.useRef)(null),eG=(0,E.k)(e=>e.nodeDark),eH=async()=>{eU.current&&(await eY.initViewer(eU.current)).setMarkdown(A.A)};(0,B.useEffect)(()=>{r(Math.random().toString(36).slice(2,10).toUpperCase());let e=new URLSearchParams(window.location.search).get("id");return Y(e||M),ey(e||M),eH(),()=>{eM()}},[]);let eW=async()=>{let e=eo.current;if(!e){let t=await eS();if(!t)return;eo.current=t,ea.current&&(ea.current.srcObject=t,await eb(ea.current));let r=t.getAudioTracks(),n=t.getVideoTracks();et(n.length>0),X(r.length>0&&r.every(e=>e.enabled)),$(n.length>0&&n.every(e=>e.enabled)),e=t}let t=e.getAudioTracks();if(!t.length)return void S.notifications.show({message:"未检测到麦克风",color:"orange"});let r=!Q;t.forEach(e=>e.enabled=r),X(r)},eL=async()=>{let e=eo.current;if(!e){let t=await eS();if(!t)return;eo.current=t,ea.current&&(ea.current.srcObject=t,await eb(ea.current));let r=t.getAudioTracks(),n=t.getVideoTracks();et(n.length>0),X(r.length>0&&r.every(e=>e.enabled)),$(n.length>0&&n.every(e=>e.enabled)),e=t}let t=e.getVideoTracks();if(!t.length)return void S.notifications.show({message:"未检测到摄像头",color:"orange"});let r=!Z;t.forEach(e=>e.enabled=r),$(r)};return(0,n.jsxs)(s.Container,{py:"md",children:[(0,n.jsx)(a.AppHeader,{title:"点对点聊天"}),(0,n.jsxs)(l.Stack,{gap:"md",children:[(0,n.jsx)(c.Center,{children:(0,n.jsx)(i.I,{name:"Chat",size:40})}),(0,n.jsxs)(d.Group,{justify:"space-between",align:"center",children:[(0,n.jsx)(u.Title,{size:"h2",children:"WebRTC + HTTP + SSE"}),(0,n.jsxs)(d.Group,{gap:"sm",children:[(0,n.jsx)(h.Badge,{size:"lg",color:ex,variant:"light","aria-live":"polite","aria-atomic":!0,children:ew}),H&&(0,n.jsx)(h.Badge,{size:"lg",color:ev,variant:"light","aria-label":"P2P 连接状态",children:ej})]})]}),(0,n.jsx)(g.Paper,{p:"md",withBorder:!0,radius:"md",children:(0,n.jsxs)(d.Group,{align:"flex-end",wrap:"wrap",justify:"space-between",children:[(0,n.jsx)(f.TextInput,{label:"房间 ID",description:"使用相同的房间 ID 才可建立连接",value:M,onChange:e=>{ey(e.currentTarget.value),Y(e.currentTarget.value)},placeholder:"输入房间 ID",flex:1,miw:280,rightSection:(0,n.jsx)(m.CopyButton,{value:M,timeout:1e3,children:e=>{let{copied:t,copy:r}=e;return(0,n.jsx)(p.Tooltip,{label:t?"已复制":"复制",children:(0,n.jsx)(y.ActionIcon,{variant:t?"filled":"light",color:t?"teal":"gray",onClick:r,"aria-label":"复制房间ID",children:t?"✓":"⧉"})})}})}),(0,n.jsx)(d.Group,{gap:"xs",wrap:"wrap",children:H?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(w.Button,{color:"red",variant:"light",onClick:eM,leftSection:(0,n.jsx)(k.A,{size:16}),children:"断开"})}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(w.Button,{onClick:()=>eO(),disabled:!t,leftSection:(0,n.jsx)(C.A,{size:16}),color:"blue",variant:"light",children:"加入"})})})]})}),H&&(0,n.jsxs)(g.Paper,{p:"md",withBorder:!0,radius:"md",children:[(0,n.jsxs)(d.Group,{justify:"space-between",align:"center",mb:"sm",children:[(0,n.jsx)(x.Text,{fw:500,children:"连接状态详情"}),(0,n.jsx)(h.Badge,{variant:"light",color:ev,children:L?"已连接":"未连接"})]}),(0,n.jsxs)(j.SimpleGrid,{cols:{base:1,sm:2},spacing:"sm",children:[(0,n.jsxs)(d.Group,{justify:"space-between",p:"xs",style:{backgroundColor:"var(--mantine-color-gray-light)",borderRadius:4},children:[(0,n.jsx)(x.Text,{size:"sm",children:"WebRTC 连接状态:"}),(0,n.jsx)(h.Badge,{size:"sm",color:"connected"===V?"green":"connecting"===V?"yellow":"gray",children:V})]}),(0,n.jsxs)(d.Group,{justify:"space-between",p:"xs",style:{backgroundColor:"var(--mantine-color-gray-light)",borderRadius:4},children:[(0,n.jsx)(x.Text,{size:"sm",children:"ICE 连接状态:"}),(0,n.jsx)(h.Badge,{size:"sm",color:"connected"===F||"completed"===F?"green":"checking"===F?"yellow":"gray",children:F})]})]}),!L&&H&&(0,n.jsx)(x.Text,{size:"sm",c:"dimmed",mt:"sm",children:"\uD83D\uDCA1 提示: 如果长时间无法建立 P2P 连接，请检查网络 IPv6 配置或尝试重新连接"}),L&&(0,n.jsxs)(d.Group,{mt:"sm",gap:"xs",children:[(0,n.jsx)(w.Button,{size:"xs",variant:"light",color:"blue",onClick:eE,children:"延迟"}),K&&(0,n.jsxs)(x.Text,{size:"xs",c:"dimmed",children:["RTT:"," ",(null==(e=K.candidatePair)?void 0:e.currentRoundTripTime)?"".concat((1e3*K.candidatePair.currentRoundTripTime).toFixed(0),"ms"):"失败"]})]})]}),(0,n.jsxs)(j.SimpleGrid,{cols:{base:1,sm:2},spacing:"md",children:[(0,n.jsxs)(g.Paper,{p:"sm",withBorder:!0,radius:"md",children:[(0,n.jsx)(c.Center,{children:(0,n.jsx)(x.Text,{children:"本地"})}),(0,n.jsxs)(v.Box,{style:{position:"relative"},children:[(0,n.jsx)("video",{ref:ea,playsInline:!0,autoPlay:!0,muted:!0,"aria-label":"本地媒体流视频",title:"本地媒体流视频",style:{width:"100%",maxWidth:560,borderRadius:8}}),ee&&!Z&&(0,n.jsx)(c.Center,{style:{position:"absolute",inset:0,borderRadius:8,backgroundColor:"var(--mantine-color-gray-light)"},children:(0,n.jsx)(d.Group,{gap:"xs",children:(0,n.jsx)(x.Text,{size:"sm",c:"dimmed",children:"摄像头已关闭"})})})]}),(0,n.jsxs)(d.Group,{justify:"center",mt:"xs",gap:"xs",children:[(0,n.jsx)(p.Tooltip,{label:Q?"关闭麦克风":"开启麦克风",children:(0,n.jsx)(w.Button,{size:"xs",variant:Q?"light":"filled",color:Q?"green":"gray",onClick:eW,disabled:!1,"aria-pressed":Q,leftSection:Q?(0,n.jsx)(P.A,{size:16}):(0,n.jsx)(R.A,{size:16}),children:"麦克风"})}),(0,n.jsx)(p.Tooltip,{label:Z?"关闭摄像头":"开启摄像头",children:(0,n.jsx)(w.Button,{size:"xs",variant:Z?"light":"filled",color:Z?"green":"gray",onClick:eL,disabled:!1,"aria-pressed":Z,leftSection:Z?(0,n.jsx)(I.A,{size:16}):(0,n.jsx)(D.A,{size:16}),children:"摄像头"})})]})]}),(0,n.jsxs)(g.Paper,{p:"sm",withBorder:!0,radius:"md",children:[(0,n.jsx)(c.Center,{children:(0,n.jsx)(x.Text,{children:"远端"})}),(0,n.jsx)("video",{ref:ei,playsInline:!0,autoPlay:!0,"aria-label":"远端媒体流视频",title:"远端媒体流视频",style:{width:"100%",maxWidth:560,borderRadius:8}})]})]}),(0,n.jsxs)(g.Paper,{p:"md",withBorder:!0,radius:"md",children:[(0,n.jsxs)(d.Group,{justify:"space-between",align:"center",mb:"sm",children:[(0,n.jsx)(x.Text,{fw:500,children:"聊天"}),(0,n.jsx)(h.Badge,{variant:"light",color:eu?"green":"gray",children:eu?"可发送":"未就绪"})]}),(0,n.jsx)(v.Box,{ref:ed,style:{height:240,overflowY:"auto",backgroundColor:"var(--mantine-color-gray-light)",borderRadius:6,padding:8},children:0===eg.length?(0,n.jsx)(c.Center,{c:"dimmed",h:220,children:(0,n.jsxs)(x.Text,{size:"sm",children:["暂无消息，",H?"开始聊天吧":"请先加入建立连接"]})}):(0,n.jsx)(l.Stack,{gap:6,children:eg.map(e=>(0,n.jsxs)(v.Box,{style:{maxWidth:"75%",marginLeft:e.self?"auto":0,marginRight:e.self?0:"auto",backgroundColor:e.self?"var(--mantine-color-blue-light)":"white",border:"1px solid var(--mantine-color-gray-3)",borderRadius:8,padding:8,textAlign:e.self?"right":"left"},"aria-label":"".concat(e.from," 的消息"),title:O.A.formatDate(e.ts),children:[(0,n.jsxs)(x.Text,{size:"xs",c:"dimmed",children:[e.from," ",O.A.formatDate(e.ts)]}),(0,n.jsx)(x.Text,{size:"sm",style:{whiteSpace:"pre-wrap"},children:e.text})]},e.id))})}),(0,n.jsxs)(d.Group,{align:"flex-end",mt:"sm",wrap:"wrap",children:[(0,n.jsx)(b.Textarea,{placeholder:eu?"输入消息 Enter 发送 Shift+Enter 换行":"文字通道未就绪",value:em,onChange:e=>ep(e.currentTarget.value),autosize:!0,minRows:1,maxRows:3,style:{flex:1},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),eB())}}),(0,n.jsx)(d.Group,{gap:"xs",children:(0,n.jsx)(w.Button,{onClick:eB,disabled:!eu||!em.trim(),children:"发送"})})]})]}),(0,n.jsx)(T.Card,{withBorder:!0,children:(0,n.jsx)(v.Box,{className:eG,ref:eU})})]})]})}},82116:(e,t,r)=>{Promise.resolve().then(r.bind(r,80262))},97443:(e,t,r)=>{"use strict";r.d(t,{A:()=>P});var n=r(43591),a=r(68110),i=r(38798),o=r(16405),s=r(82127),l=r(34477),c=r(55544),d=r(85179),u=r(56612),h=r(86710),g=r(36117),f=r.n(g),m=r(44839),p=r.n(m);r(28223);var y=r(78595),w=r.n(y),x=r(28555),j=r.n(x);f().extend(w()),f().extend(p()),f().locale("zh-cn");let v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYYMM",r=f()().isoWeek(),n=f()().format(t)+r,a=sessionStorage.getItem("fingerprint");if(!a)throw Error("请先获取设备指纹");let i=[location.origin,a].join("/"),{public_key:o,private_key:s}=(0,u.BP)(n,i);return(0,u.yO)(JSON.stringify(e),o,s)},b=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYYMM",r=f()().isoWeek(),n=f()().format(t)+r,a=sessionStorage.getItem("fingerprint");if(!a)throw Error("请先获取设备指纹");let i=[location.origin,a].join("/"),{public_key:o,private_key:s}=(0,u.BP)(n,i),l=(0,u.OM)(e,o,s);if(!l)throw Error("jwt 解析失败");let c=JSON.parse(l);if(!c.address)throw Error("jwt json 解析失败");return c},T=async e=>{let t=Date.now().toString(),r=i.QX.fromPhrase(e.mnemonic),n=await r.signMessage(t);localStorage.token=[e.address,t,n].join(".")},S=e=>{try{var t;let r=v(e);if((null==(t=b(r))?void 0:t.address)===e.address)return localStorage.setItem("jwt",r),T(e),e}catch(e){console.log("登录失败:",e)}return null},k=(e,t)=>{let r=t.slice(2),n=new Uint8Array((0,o.q5)(e+r));return j().sign.keyPair.fromSecretKey(n)},C={avatar:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Most";return(0,l.gn)(c,{seed:"most.box@"+e,flip:!0,backgroundType:["gradientLinear"]}).toDataUri()},avatarCID:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Most";return(0,l.gn)(d,{seed:"most.box#"+e,flip:!0,backgroundType:["gradientLinear","solid"]}).toDataUri()},formatTime:e=>{let t;if(!e)return"";let r=f()(Number(e)),n=r.hour();return t=n>=0&&n<3?"凌晨":n>=3&&n<6?"拂晓":n>=6&&n<9?"早晨":n>=9&&n<12?"上午":n>=12&&n<15?"下午":n>=15&&n<18?"傍晚":n>=18&&n<21?"薄暮":"深夜",r.format("YYYY年M月D日 ".concat(t,"h点m分"))},formatDate:e=>{let t=f()(Number(e)),r=f()();if(t.isSame(r,"minute"))return t.format("HH:mm:ss");if(t.isSame(r,"day"))return t.format("HH:mm");if(t.isSame(r.subtract(1,"day"),"day"))return"昨天 ".concat(t.format("HH:mm"));if(t.isoWeek()===r.isoWeek())return"".concat(["周日","周一","周二","周三","周四","周五","周六"][t.day()]," ").concat(t.format("HH:mm"));if(t.year()===r.year())return t.format("M月D日");else return t.format("YY年M月D日")},formatAddress:e=>e?e.slice(0,6)+"..."+e.slice(-4):"",enBase64:e=>(0,n.W)((0,a.YW)(e)),deBase64:e=>(0,a._v)((0,n.y)(e)),createJWT:v,verifyJWT:b,login:(e,t)=>S((0,u.BP)(e,t,"I know loss mnemonic will lose my wallet.")),loginSave:S,ZeroAddress:s.j,createToken:T,pinyin:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(t.length<r)return!1;if(e.toLowerCase().includes(t.toLowerCase()))return!0;let n=(0,h.YW)(e,t,{continuous:!0});return!!n&&!!(n.length>=r)},openDot:e=>{let t=new URL("/auth/jwt/",e),r=localStorage.getItem("jwt");if(r){let e=C.verifyJWT(r);if(e){let r=f()().format("YY/M/D HH:mm"),{public_key:n,private_key:a}=(0,u.BP)("auth/jwt",r),i=(0,u.yO)(JSON.stringify(e),n,a);t.searchParams.set("token",i)}}window.open(t.href)},getEdKeyPair:k,getIPNS:(e,t)=>{let r=(e=>{let t=new Uint8Array([8,1,18,...(e=>{let t=[];for(;e>=128;)t.push(127&e|128),e>>=7;return t.push(e),t})(e.length)]),r=new Uint8Array(t.length+e.length);return r.set(t,0),r.set(e,t.length),r})(k(e,t).publicKey),n=new Uint8Array(2+r.length);n[0]=0,n[1]=36,n.set(r,2);let a=new Uint8Array([1,114]),i=new Uint8Array(a.length+n.length);return i.set(a,0),i.set(n,a.length),"k"+((e,t)=>{if(0===e.length)return"";let r=t.length,n=0;for(;n<e.length&&0===e[n];)n++;let a=[0];for(let t=n;t<e.length;t++){let n=e[t];for(let e=0;e<a.length;e++){let t=256*a[e]+n;a[e]=t%r,n=Math.floor(t/r)}for(;n>0;)a.push(n%r),n=Math.floor(n/r)}let i="";for(let e=0;e<n;e++)i+=t[0];for(let e=a.length-1;e>=0;e--)i+=t[a[e]];return i})(i,"0123456789abcdefghijklmnopqrstuvwxyz")}},P=C}},e=>{e.O(0,[8198,2545,642,2794,5619,6714,8555,8835,5125,6476,9287,3584,5595,9457,9919,8617,101,8289,8441,1255,7358],()=>e(e.s=82116)),_N_E=e.O()}]);