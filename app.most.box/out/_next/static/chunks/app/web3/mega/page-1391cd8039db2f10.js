(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4099],{4673:(e,t,o)=>{"use strict";o.d(t,{BP:()=>m,OM:()=>p,yO:()=>g});var n=o(30167),r=o(71425),a=o(44532),s=o(87788),l=o(56076),i=o(51544),c=o(70358),d=o(26634),u=o.n(d);let m=(e,t,o)=>{let c=(0,n.YW)(t),d=(0,n.YW)("/most.box/"+e),m=(0,r.A)(c,d,3,32,"sha512"),g=(0,a.q5)((0,s.s)(m)),p=g.slice(0,32),h=u().box.keyPair.fromSecretKey(p),w=(0,a.c$)(h.publicKey),f=(0,a.c$)(h.secretKey),y=l.v.entropyToPhrase(g);return{username:e,address:i.QX.fromPhrase(y).address,public_key:w,private_key:f,mnemonic:"I know loss mnemonic will lose my wallet."===o?y:""}},g=(e,t,o)=>{let n=new TextEncoder().encode(e),r=u().randomBytes(u().box.nonceLength),s=u().box(n,r,new Uint8Array((0,a.q5)(t)),new Uint8Array((0,a.q5)(o)));return s?["mp://2",(0,c.W)(r),(0,c.W)(s)].join("."):(console.info("加密失败"),"")},p=(e,t,o)=>{let[n,r,s]=e.split(".");if("mp://2"!==n)return console.info("无效的密文"),"";let l=u().box.open((0,c.y)(s),(0,c.y)(r),new Uint8Array((0,a.q5)(t)),new Uint8Array((0,a.q5)(o)));return l?new TextDecoder().decode(l):(console.info("解密失败"),"")}},7248:(e,t,o)=>{"use strict";o.d(t,{h:()=>r});var n=o(35695);let r=()=>{let e=(0,n.useRouter)(),t=(0,n.usePathname)();return()=>{sessionStorage.firstPath===t?(sessionStorage.firstPath="/",e.replace("/")):e.back()}}},9482:(e,t,o)=>{"use strict";o.d(t,{A:()=>j});var n=o(70358),r=o(30167),a=o(51544),s=o(19396),l=o(96842),i=o(42995),c=o(3648),d=o(4673),u=o(30832),m=o.n(u),g=o(99758),p=o.n(g);o(38464);var h=o(76920),w=o.n(h);m().extend(w()),m().extend(p()),m().locale("zh-cn");let f=e=>{let t=String(Date.now()),o=(0,n.W)(crypto.getRandomValues(new Uint8Array(32))),r=sessionStorage.getItem("fingerprint")||"",a=[t,o].join("."),{public_key:s,private_key:l}=(0,d.BP)(r,a);return{jwt:(0,d.yO)(JSON.stringify(e),s,l),jwtSecret:a}},y=(e,t)=>{let[o]=t.split(".");if(Date.now()-Number(o)>864e5)return console.log("jwt 已过期"),null;try{let o=sessionStorage.getItem("fingerprint")||"",{public_key:n,private_key:r}=(0,d.BP)(o,t),a=(0,d.OM)(e,n,r);if(a)return JSON.parse(a)}catch(e){console.log("验证失败:",e)}return null},x=async e=>{let t=Date.now().toString(),o=a.QX.fromPhrase(e.mnemonic),n=await o.signMessage(t);localStorage.token=[e.address,t,n].join(".")},v=async()=>{try{let e=new Audio("/sounds/notification.mp3");await e.play(),navigator.vibrate(200)}catch(e){console.log("播放提示音时出错:",e)}},j={topic:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Most";return(0,l.gn)(c,{seed:"most.box#"+e,flip:!0,backgroundType:["gradientLinear","solid"]}).toDataUri()},avatar:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Most";return(0,l.gn)(i,{seed:"most.box@"+e,flip:!0,backgroundType:["gradientLinear"]}).toDataUri()},getHash:e=>{let t=0;for(let o=0;o<e.length;o++)t=(t<<5)-t+e.charCodeAt(o),t&=t;return Math.abs(t).toString(36)},formatTime:e=>{let t;if(!e)return"";let o=m()(Number(e)),n=o.hour();return t=n>=0&&n<3?"凌晨":n>=3&&n<6?"拂晓":n>=6&&n<9?"早晨":n>=9&&n<12?"上午":n>=12&&n<15?"下午":n>=15&&n<18?"傍晚":n>=18&&n<21?"薄暮":"深夜",o.format("YYYY年M月D日 ".concat(t,"h点m分"))},formatDate:e=>{let t=m()(Number(e)),o=m()();return t.isSame(o,"day")?t.format("HH:mm"):t.isSame(o.subtract(1,"day"),"day")?"昨天 ".concat(t.format("HH:mm")):t.isoWeek()===o.isoWeek()?"".concat(["周日","周一","周二","周三","周四","周五","周六"][t.day()]," ").concat(t.format("HH:mm")):t.year()===o.year()?t.format("M月D日"):t.format("YY年M月D日")},formatAddress:e=>e?e.slice(0,6)+"..."+e.slice(-4):"",enBase64:e=>(0,n.W)((0,r.YW)(e)),deBase64:e=>(0,r._v)((0,n.y)(e)),createJWT:f,verifyJWT:y,login:(e,t)=>{try{var o;let n=(0,d.BP)(e,t,"I know loss mnemonic will lose my wallet."),{jwt:r,jwtSecret:a}=f(n);if((null==(o=y(r,a))?void 0:o.address)===n.address)return localStorage.setItem("jwt",r),localStorage.setItem("jwtSecret",a),x(n),n}catch(e){console.log("登录失败:",e)}return null},ZeroAddress:s.j,topicJoin:(e,t)=>t?[e,t].join("➔"):e,topicSplit:e=>{e.startsWith("#")&&(e=e.substring(1));let[t,o]=decodeURIComponent(e).split("➔");return[t||"",o||""]},playSound:v,createToken:x}},48764:(e,t,o)=>{"use strict";o.d(t,{k:()=>l});var n=o(9482),r=o(65453),a=o(54205),s=o(6942);let l=(0,r.v)(e=>({wallet:void 0,initWallet(){let t=localStorage.getItem("jwt"),o=localStorage.getItem("jwtSecret");if(t&&o){let r=n.A.verifyJWT(t,o);r&&(n.A.createToken(r),e({wallet:r}))}},async updateDot(t,o){let n=new URL(t).origin;try{let t=await (0,a.FH)(n+"/ipv6"),r=new Set(t.data);if(r.add(n),a.FH.defaults.baseURL=n,e({dotAPI:n}),localStorage.dotAPI=n,o||s.notifications.show({title:"节点已切换",message:n,color:"green"}),n.endsWith("1976")){let t=n.slice(0,-4)+"8080";e({dotCID:t}),localStorage.dotCID=t}return Array.from(r)}catch(t){s.notifications.show({title:"节点未切换",message:n,color:"red"}),console.error(t),e({dotAPI:a.FH.defaults.baseURL||""})}return null},setItem:(t,o)=>e(e=>({...e,[t]:o})),firstPath:"",dotAPI:a.MN,dotCID:a.AF,exit(){e({wallet:void 0}),localStorage.removeItem("jwt"),localStorage.removeItem("jwtSecret")}}))},49739:(e,t,o)=>{Promise.resolve().then(o.bind(o,99929))},54205:(e,t,o)=>{"use strict";o.d(t,{AF:()=>a,FH:()=>s,MN:()=>r});var n=o(23464);let r="https://dot.most.red",a="https://cid.most.red",s=n.A.create({baseURL:r});s.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization=t),e},e=>Promise.reject(e))},66810:()=>{},71281:()=>{},80630:(e,t,o)=>{"use strict";o.d(t,{AppHeader:()=>c});var n=o(95155),r=o(70112),a=o(81001),s=o(58887),l=o(30578),i=o(7248);let c=e=>{let{title:t,right:o}=e,c=(0,i.h)();return(0,n.jsxs)(r.Group,{className:"app-header",children:[(0,n.jsx)(a.ActionIcon,{variant:"transparent",onClick:c,color:"--text-color",children:(0,n.jsx)(l.I,{name:"back",size:24})}),(0,n.jsx)(s.Text,{lineClamp:2,variant:"gradient",children:t}),o||(0,n.jsx)(a.ActionIcon,{variant:"transparent",color:"--text-color",children:(0,n.jsx)(l.I,{name:"more",size:24})})]})}},99929:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>h});var n=o(95155),r=o(80630),a=o(69604),s=o(26903),l=o(12115),i=o(89902),c=o(77635),d=o(62741),u=o(6874),m=o.n(u),g=o(6942);o(66810);var p=o(48764);function h(){var e;let t=(0,p.k)(e=>e.wallet),[o,u]=(0,l.useState)(null),[h,w]=(0,l.useState)("mega"),f={mega:{rpc:"https://carrot.megaeth.com/rpc",explorer:"https://www.megaexplorer.xyz",faucet:"https://testnet.megaeth.com/#2",name:"Mega ETH"},monad:{rpc:"https://testnet-rpc.monad.xyz",explorer:"https://testnet.monadexplorer.com",faucet:"https://faucet.monad.xyz",name:"Monad"}};(0,l.useEffect)(()=>{let e=e=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)&&(u(e.key),e.preventDefault())},t=()=>{u(null)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[]);let y=e=>{u(e)},x=()=>{u(null)},[v]=(0,l.useState)(new i.FR(f.mega.rpc)),[j]=(0,l.useState)(new i.FR(f.monad.rpc)),[A,S]=(0,l.useState)(null),[k,b]=(0,l.useState)(null),[M,I]=(0,l.useState)(null),[D,U]=(0,l.useState)(null),L=async e=>{try{let t=await v.getTransactionCount(e);I(t),console.log("".concat(f.mega.name," 网络 nonce:"),t);let o=await j.getTransactionCount(e);U(o),console.log("".concat(f.monad.name," 网络 nonce:"),o)}catch(e){console.error("获取 nonce 失败:",e)}};(0,l.useEffect)(()=>{if(t){let e=c.u.fromPhrase(t.mnemonic);S(e.connect(v)),b(e.connect(j)),L(e.address)}},[t]);let N=async()=>{let e="mega"===h?A:k,t="mega"===h?M:D;if(null!==e&&null!==t)try{"mega"===h?I(t+1):U(t+1);let o=await e.sendTransaction({to:e.address,value:d.g5("0"),nonce:t});console.log("交易哈希:",f[h].explorer+"/tx/"+o.hash),g.notifications.show({color:"green",title:"".concat(f[h].name," 交易哈希"),message:o.hash})}catch(e){console.error("交易失败:",e),g.notifications.show({color:"red",title:"交易失败",message:e.message})}};(0,l.useEffect)(()=>{o&&(console.log("按下按键:",o),g.notifications.show({title:"按下按键",message:o}),N())},[o]);let P=()=>"mega"===h?A:k;return(0,n.jsxs)(a.Box,{id:"page-mega",children:[(0,n.jsx)(r.AppHeader,{title:"".concat(f[h].name," 测试网")}),t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{style:{marginBottom:"15px"},children:(0,n.jsxs)(s.Button.Group,{children:[(0,n.jsx)(s.Button,{variant:"mega"===h?"filled":"outline",onClick:()=>w("mega"),children:"Mega ETH"}),(0,n.jsx)(s.Button,{variant:"monad"===h?"filled":"outline",onClick:()=>w("monad"),children:"Monad"})]})}),P()&&(0,n.jsxs)("p",{children:[f[h].explorer,"/address/",null==(e=P())?void 0:e.address]}),(0,n.jsx)("p",{children:f[h].rpc}),(0,n.jsx)("p",{children:(0,n.jsxs)(m(),{href:f[h].faucet,target:"_blank",children:[f[h].name," 水龙头"]})}),(0,n.jsxs)("p",{children:["Nonce: ","mega"===h?M:D]}),(0,n.jsx)("div",{className:"keyboard-container",children:(0,n.jsxs)("div",{className:"key-pad",children:[(0,n.jsx)(s.Button,{className:"direction-key up ".concat("ArrowUp"===o?"pressed":""),onMouseDown:()=>y("ArrowUp"),onMouseUp:x,onMouseLeave:x,children:"↑"}),(0,n.jsx)(s.Button,{className:"direction-key left ".concat("ArrowLeft"===o?"pressed":""),onMouseDown:()=>y("ArrowLeft"),onMouseUp:x,onMouseLeave:x,children:"←"}),(0,n.jsx)(s.Button,{className:"direction-key down ".concat("ArrowDown"===o?"pressed":""),onMouseDown:()=>y("ArrowDown"),onMouseUp:x,onMouseLeave:x,children:"↓"}),(0,n.jsx)(s.Button,{className:"direction-key right ".concat("ArrowRight"===o?"pressed":""),onMouseDown:()=>y("ArrowRight"),onMouseUp:x,onMouseLeave:x,children:"→"})]})})]}):(0,n.jsx)(s.Button,{variant:"gradient",component:m(),href:"/login",children:"请先登录"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[1697,9729,5232,5604,6874,9902,6222,578,8441,2721,7358],()=>t(49739)),_N_E=e.O()}]);