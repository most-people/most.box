(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4099],{4673:(e,t,o)=>{"use strict";o.d(t,{BP:()=>m,OM:()=>h,yO:()=>g});var n=o(30167),r=o(71425),a=o(44532),s=o(87788),l=o(56076),i=o(88413),c=o(70358),d=o(26634),u=o.n(d);let m=(e,t,o)=>{let c=(0,n.YW)(t),d=(0,n.YW)("/most.box/"+e),m=(0,r.A)(c,d,3,32,"sha512"),g=(0,a.q5)((0,s.s)(m)),h=g.slice(0,32),p=u().box.keyPair.fromSecretKey(h),w=(0,a.c$)(p.publicKey),f=(0,a.c$)(p.secretKey),y=l.v.entropyToPhrase(g);return{username:e,address:i.QX.fromPhrase(y).address,public_key:w,private_key:f,mnemonic:"I know loss mnemonic will lose my wallet."===o?y:""}},g=(e,t,o)=>{let n=new TextEncoder().encode(e),r=u().randomBytes(u().box.nonceLength),s=u().box(n,r,new Uint8Array((0,a.q5)(t)),new Uint8Array((0,a.q5)(o)));return s?["mp://2",(0,c.W)(r),(0,c.W)(s)].join("."):(console.info("加密失败"),"")},h=(e,t,o)=>{let[n,r,s]=e.split(".");if("mp://2"!==n)return console.info("无效的密文"),"";let l=u().box.open((0,c.y)(s),(0,c.y)(r),new Uint8Array((0,a.q5)(t)),new Uint8Array((0,a.q5)(o)));return l?new TextDecoder().decode(l):(console.info("解密失败"),"")}},7248:(e,t,o)=>{"use strict";o.d(t,{h:()=>r});var n=o(35695);let r=()=>{let e=(0,n.useRouter)(),t=(0,n.usePathname)();return()=>{sessionStorage.firstPath===t?(sessionStorage.firstPath="/",e.replace("/")):e.back()}}},9482:(e,t,o)=>{"use strict";o.d(t,{A:()=>j});var n=o(70358),r=o(30167),a=o(88413),s=o(19396),l=o(96842),i=o(42995),c=o(3648),d=o(4673),u=o(59909),m=o(30832),g=o.n(m),h=o(99758),p=o.n(h);o(38464);var w=o(76920),f=o.n(w);g().extend(f()),g().extend(p()),g().locale("zh-cn");let y=e=>{let t=String(Date.now()),o=(0,n.W)(crypto.getRandomValues(new Uint8Array(32))),r=sessionStorage.getItem("fingerprint")||"",a=[location.origin,r].join("/"),s=[t,o].join("."),{public_key:l,private_key:i}=(0,d.BP)(a,s);return{jwt:(0,d.yO)(JSON.stringify(e),l,i),jwtSecret:s}},x=(e,t)=>{let[o]=t.split(".");if(Date.now()-Number(o)>288e5)return console.log("jwt 已过期"),null;try{let o=sessionStorage.getItem("fingerprint")||"",n=[location.origin,o].join("/"),{public_key:r,private_key:a}=(0,d.BP)(n,t),s=(0,d.OM)(e,r,a);if(s)return JSON.parse(s)}catch(e){console.log("验证失败:",e)}return null},v=async e=>{let t=Date.now().toString(),o=a.QX.fromPhrase(e.mnemonic),n=await o.signMessage(t);localStorage.token=[e.address,t,n].join(".")},j={avatar:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Most";return(0,l.gn)(i,{seed:"most.box@"+e,flip:!0,backgroundType:["gradientLinear"]}).toDataUri()},avatarCID:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Most";return(0,l.gn)(c,{seed:"most.box#"+e,flip:!0,backgroundType:["gradientLinear","solid"]}).toDataUri()},formatTime:e=>{let t;if(!e)return"";let o=g()(Number(e)),n=o.hour();return t=n>=0&&n<3?"凌晨":n>=3&&n<6?"拂晓":n>=6&&n<9?"早晨":n>=9&&n<12?"上午":n>=12&&n<15?"下午":n>=15&&n<18?"傍晚":n>=18&&n<21?"薄暮":"深夜",o.format("YYYY年M月D日 ".concat(t,"h点m分"))},formatDate:e=>{let t=g()(Number(e)),o=g()();return t.isSame(o,"day")?t.format("HH:mm"):t.isSame(o.subtract(1,"day"),"day")?"昨天 ".concat(t.format("HH:mm")):t.isoWeek()===o.isoWeek()?"".concat(["周日","周一","周二","周三","周四","周五","周六"][t.day()]," ").concat(t.format("HH:mm")):t.year()===o.year()?t.format("M月D日"):t.format("YY年M月D日")},formatAddress:e=>e?e.slice(0,6)+"..."+e.slice(-4):"",enBase64:e=>(0,n.W)((0,r.YW)(e)),deBase64:e=>(0,r._v)((0,n.y)(e)),createJWT:y,verifyJWT:x,login:(e,t)=>{try{var o;let n=(0,d.BP)(e,t,"I know loss mnemonic will lose my wallet."),{jwt:r,jwtSecret:a}=y(n);if((null==(o=x(r,a))?void 0:o.address)===n.address)return localStorage.setItem("jwt",r),localStorage.setItem("jwtSecret",a),v(n),n}catch(e){console.log("登录失败:",e)}return null},ZeroAddress:s.j,createToken:v,pinyin:function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(t.length<o)return!1;if(e.toLowerCase().includes(t.toLowerCase()))return!0;let n=(0,u.YW)(e,t,{continuous:!0});return!!n&&!!(n.length>=o)}}},48764:(e,t,o)=>{"use strict";o.d(t,{k:()=>l});var n=o(9482),r=o(65453),a=o(54205),s=o(6942);let l=(0,r.v)((e,t)=>({wallet:void 0,initWallet(){let o=localStorage.getItem("jwt"),r=localStorage.getItem("jwtSecret");if(o&&r){let a=n.A.verifyJWT(o,r);a?(n.A.createToken(a),e({wallet:a})):t().exit()}},async updateDot(t,o){let n=new URL(t).origin;try{let t=(await (0,a.FH)(n+"/dot")).data;a.FH.defaults.baseURL=n,e({dotAPI:n}),localStorage.setItem("dotAPI",n),o||s.notifications.show({title:"节点已切换",message:n,color:"green"});let r=t.CIDs[0];r&&(e({dotCID:r}),localStorage.setItem("dotCID",r))}catch(t){s.notifications.show({title:"节点未切换",message:n,color:"red"}),console.error(t),e({dotAPI:a.FH.defaults.baseURL||""})}return null},setItem:(t,o)=>e(e=>({...e,[t]:o})),firstPath:"",dotAPI:a.MN,dotCID:a.AF,exit(){e({wallet:void 0}),localStorage.removeItem("jwt"),localStorage.removeItem("jwtSecret"),localStorage.removeItem("token")},notes:[]}))},49739:(e,t,o)=>{Promise.resolve().then(o.bind(o,99929))},54205:(e,t,o)=>{"use strict";o.d(t,{AF:()=>a,C2:()=>s,FH:()=>l,MN:()=>r});var n=o(23464);let r="https://dot.most.red",a="https://cid.most.red",s="https://most.box/auth/callback",l=n.A.create({baseURL:r});l.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization=t),e},e=>Promise.reject(e))},66810:()=>{},71281:()=>{},80630:(e,t,o)=>{"use strict";o.d(t,{AppHeader:()=>c});var n=o(95155),r=o(70112),a=o(81001),s=o(58887),l=o(49785),i=o(7248);let c=e=>{let{title:t,right:o}=e,c=(0,i.h)();return(0,n.jsxs)(r.Group,{className:"app-header",children:[(0,n.jsx)(a.ActionIcon,{variant:"transparent",onClick:c,color:"--text-color",children:(0,n.jsx)(l.I,{name:"Back",size:24})}),(0,n.jsx)(s.Text,{lineClamp:2,variant:"gradient",children:t}),o||(0,n.jsx)(a.ActionIcon,{variant:"transparent",color:"--text-color",children:(0,n.jsx)(l.I,{name:"More",size:24})})]})}},99929:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>p});var n=o(95155),r=o(80630),a=o(69604),s=o(26903),l=o(12115),i=o(59117),c=o(39329),d=o(67703),u=o(6874),m=o.n(u),g=o(6942);o(66810);var h=o(48764);function p(){var e;let t=(0,h.k)(e=>e.wallet),[o,u]=(0,l.useState)(null),[p,w]=(0,l.useState)("mega"),f={mega:{rpc:"https://carrot.megaeth.com/rpc",explorer:"https://www.megaexplorer.xyz",faucet:"https://testnet.megaeth.com/#2",name:"Mega ETH"},monad:{rpc:"https://testnet-rpc.monad.xyz",explorer:"https://testnet.monadexplorer.com",faucet:"https://faucet.monad.xyz",name:"Monad"}};(0,l.useEffect)(()=>{let e=e=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)&&(u(e.key),e.preventDefault())},t=()=>{u(null)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[]);let y=e=>{u(e)},x=()=>{u(null)},[v]=(0,l.useState)(new i.FR(f.mega.rpc)),[j]=(0,l.useState)(new i.FR(f.monad.rpc)),[k,A]=(0,l.useState)(null),[S,M]=(0,l.useState)(null),[I,b]=(0,l.useState)(null),[D,L]=(0,l.useState)(null),B=async e=>{try{let t=await v.getTransactionCount(e);b(t),console.log("".concat(f.mega.name," 网络 nonce:"),t);let o=await j.getTransactionCount(e);L(o),console.log("".concat(f.monad.name," 网络 nonce:"),o)}catch(e){console.error("获取 nonce 失败:",e)}};(0,l.useEffect)(()=>{if(t){let e=c.u.fromPhrase(t.mnemonic);A(e.connect(v)),M(e.connect(j)),B(e.address)}},[t]);let N=async()=>{let e="mega"===p?k:S,t="mega"===p?I:D;if(null!==e&&null!==t)try{"mega"===p?b(t+1):L(t+1);let o=await e.sendTransaction({to:e.address,value:d.g5("0"),nonce:t});console.log("交易哈希:",f[p].explorer+"/tx/"+o.hash),g.notifications.show({color:"green",title:"".concat(f[p].name," 交易哈希"),message:o.hash})}catch(e){console.error("交易失败:",e),g.notifications.show({color:"red",title:"交易失败",message:e.message})}};(0,l.useEffect)(()=>{o&&(console.log("按下按键:",o),g.notifications.show({title:"按下按键",message:o}),N())},[o]);let P=()=>"mega"===p?k:S;return(0,n.jsxs)(a.Box,{id:"page-mega",children:[(0,n.jsx)(r.AppHeader,{title:"".concat(f[p].name," 测试网")}),t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{style:{marginBottom:"15px"},children:(0,n.jsxs)(s.Button.Group,{children:[(0,n.jsx)(s.Button,{variant:"mega"===p?"filled":"outline",onClick:()=>w("mega"),children:"Mega ETH"}),(0,n.jsx)(s.Button,{variant:"monad"===p?"filled":"outline",onClick:()=>w("monad"),children:"Monad"})]})}),P()&&(0,n.jsxs)("p",{children:[f[p].explorer,"/address/",null==(e=P())?void 0:e.address]}),(0,n.jsx)("p",{children:f[p].rpc}),(0,n.jsx)("p",{children:(0,n.jsxs)(m(),{href:f[p].faucet,target:"_blank",children:[f[p].name," 水龙头"]})}),(0,n.jsxs)("p",{children:["Nonce: ","mega"===p?I:D]}),(0,n.jsx)("div",{className:"keyboard-container",children:(0,n.jsxs)("div",{className:"key-pad",children:[(0,n.jsx)(s.Button,{className:"direction-key up ".concat("ArrowUp"===o?"pressed":""),onMouseDown:()=>y("ArrowUp"),onMouseUp:x,onMouseLeave:x,children:"↑"}),(0,n.jsx)(s.Button,{className:"direction-key left ".concat("ArrowLeft"===o?"pressed":""),onMouseDown:()=>y("ArrowLeft"),onMouseUp:x,onMouseLeave:x,children:"←"}),(0,n.jsx)(s.Button,{className:"direction-key down ".concat("ArrowDown"===o?"pressed":""),onMouseDown:()=>y("ArrowDown"),onMouseUp:x,onMouseLeave:x,children:"↓"}),(0,n.jsx)(s.Button,{className:"direction-key right ".concat("ArrowRight"===o?"pressed":""),onMouseDown:()=>y("ArrowRight"),onMouseUp:x,onMouseLeave:x,children:"→"})]})})]}):(0,n.jsx)(s.Button,{variant:"gradient",component:m(),href:"/login",children:"请先登录"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[1697,8198,8887,9549,5483,8694,5604,6874,9117,3775,5674,9785,8441,2721,7358],()=>t(49739)),_N_E=e.O()}]);