(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4099],{4673:(e,t,n)=>{"use strict";n.d(t,{BP:()=>m,OM:()=>h,yO:()=>g});var o=n(30167),r=n(71425),a=n(44532),s=n(87788),l=n(56076),i=n(51544),c=n(70358),d=n(26634),u=n.n(d);let m=(e,t,n)=>{let c=(0,o.YW)(t),d=(0,o.YW)("/most.box/"+e),m=(0,r.A)(c,d,3,32,"sha512"),g=(0,a.q5)((0,s.s)(m)),h=g.slice(0,32),p=u().box.keyPair.fromSecretKey(h),w=(0,a.c$)(p.publicKey),f=(0,a.c$)(p.secretKey),y=l.v.entropyToPhrase(g);return{username:e,address:i.QX.fromPhrase(y).address,public_key:w,private_key:f,mnemonic:"I know loss mnemonic will lose my wallet."===n?y:""}},g=(e,t,n)=>{let o=new TextEncoder().encode(e),r=u().randomBytes(u().box.nonceLength),s=u().box(o,r,new Uint8Array((0,a.q5)(t)),new Uint8Array((0,a.q5)(n)));return s?["mp://2",(0,c.W)(r),(0,c.W)(s)].join("."):(console.info("加密失败"),"")},h=(e,t,n)=>{let[o,r,s]=e.split(".");if("mp://2"!==o)return console.info("无效的密文"),"";let l=u().box.open((0,c.y)(s),(0,c.y)(r),new Uint8Array((0,a.q5)(t)),new Uint8Array((0,a.q5)(n)));return l?new TextDecoder().decode(l):(console.info("解密失败"),"")}},7248:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});var o=n(35695);let r=()=>{let e=(0,o.useRouter)(),t=(0,o.usePathname)();return()=>{sessionStorage.firstPath===t?(sessionStorage.firstPath="/",e.replace("/")):e.back()}}},9482:(e,t,n)=>{"use strict";n.d(t,{A:()=>j});var o=n(70358),r=n(30167),a=n(51544),s=n(19396),l=n(96842),i=n(42995),c=n(3648),d=n(4673),u=n(59909),m=n(30832),g=n.n(m),h=n(99758),p=n.n(h);n(38464);var w=n(76920),f=n.n(w);g().extend(f()),g().extend(p()),g().locale("zh-cn");let y=e=>{let t=String(Date.now()),n=(0,o.W)(crypto.getRandomValues(new Uint8Array(32))),r=sessionStorage.getItem("fingerprint")||"",a=[t,n].join("."),{public_key:s,private_key:l}=(0,d.BP)(r,a);return{jwt:(0,d.yO)(JSON.stringify(e),s,l),jwtSecret:a}},x=(e,t)=>{let[n]=t.split(".");if(Date.now()-Number(n)>288e5)return console.log("jwt 已过期"),null;try{let n=sessionStorage.getItem("fingerprint")||"",{public_key:o,private_key:r}=(0,d.BP)(n,t),a=(0,d.OM)(e,o,r);if(a)return JSON.parse(a)}catch(e){console.log("验证失败:",e)}return null},v=async e=>{let t=Date.now().toString(),n=a.QX.fromPhrase(e.mnemonic),o=await n.signMessage(t);localStorage.token=[e.address,t,o].join(".")},j={avatar:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Most";return(0,l.gn)(i,{seed:"most.box@"+e,flip:!0,backgroundType:["gradientLinear"]}).toDataUri()},avatarCID:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Most";return(0,l.gn)(c,{seed:"most.box#"+e,flip:!0,backgroundType:["gradientLinear","solid"]}).toDataUri()},formatTime:e=>{let t;if(!e)return"";let n=g()(Number(e)),o=n.hour();return t=o>=0&&o<3?"凌晨":o>=3&&o<6?"拂晓":o>=6&&o<9?"早晨":o>=9&&o<12?"上午":o>=12&&o<15?"下午":o>=15&&o<18?"傍晚":o>=18&&o<21?"薄暮":"深夜",n.format("YYYY年M月D日 ".concat(t,"h点m分"))},formatDate:e=>{let t=g()(Number(e)),n=g()();return t.isSame(n,"day")?t.format("HH:mm"):t.isSame(n.subtract(1,"day"),"day")?"昨天 ".concat(t.format("HH:mm")):t.isoWeek()===n.isoWeek()?"".concat(["周日","周一","周二","周三","周四","周五","周六"][t.day()]," ").concat(t.format("HH:mm")):t.year()===n.year()?t.format("M月D日"):t.format("YY年M月D日")},formatAddress:e=>e?e.slice(0,6)+"..."+e.slice(-4):"",enBase64:e=>(0,o.W)((0,r.YW)(e)),deBase64:e=>(0,r._v)((0,o.y)(e)),createJWT:y,verifyJWT:x,login:(e,t)=>{try{var n;let o=(0,d.BP)(e,t,"I know loss mnemonic will lose my wallet."),{jwt:r,jwtSecret:a}=y(o);if((null==(n=x(r,a))?void 0:n.address)===o.address)return localStorage.setItem("jwt",r),localStorage.setItem("jwtSecret",a),v(o),o}catch(e){console.log("登录失败:",e)}return null},ZeroAddress:s.j,createToken:v,pinyin:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(t.length<n)return!1;if(e.toLowerCase().includes(t.toLowerCase()))return!0;let o=(0,u.YW)(e,t,{continuous:!0});return!!o&&!!(o.length>=n)}}},48764:(e,t,n)=>{"use strict";n.d(t,{k:()=>l});var o=n(9482),r=n(65453),a=n(54205),s=n(6942);let l=(0,r.v)((e,t)=>({wallet:void 0,initWallet(){let n=localStorage.getItem("jwt"),r=localStorage.getItem("jwtSecret");if(n&&r){let a=o.A.verifyJWT(n,r);a?(o.A.createToken(a),e({wallet:a})):t().exit()}},async updateDot(t,n){let o=new URL(t).origin;try{let t=await (0,a.FH)(o+"/ipv6"),r=new Set(t.data);if(r.add(o),a.FH.defaults.baseURL=o,e({dotAPI:o}),localStorage.dotAPI=o,n||s.notifications.show({title:"节点已切换",message:o,color:"green"}),o.endsWith("1976")){let t=o.slice(0,-4)+"8080";e({dotCID:t}),localStorage.dotCID=t}return Array.from(r)}catch(t){s.notifications.show({title:"节点未切换",message:o,color:"red"}),console.error(t),e({dotAPI:a.FH.defaults.baseURL||""})}return null},setItem:(t,n)=>e(e=>({...e,[t]:n})),firstPath:"",dotAPI:a.MN,dotCID:a.AF,exit(){e({wallet:void 0}),localStorage.removeItem("jwt"),localStorage.removeItem("jwtSecret")},notes:[]}))},49739:(e,t,n)=>{Promise.resolve().then(n.bind(n,99929))},54205:(e,t,n)=>{"use strict";n.d(t,{AF:()=>a,FH:()=>s,MN:()=>r});var o=n(23464);let r="https://dot.most.red",a="https://cid.most.red",s=o.A.create({baseURL:r});s.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization=t),e},e=>Promise.reject(e))},66810:()=>{},71281:()=>{},80630:(e,t,n)=>{"use strict";n.d(t,{AppHeader:()=>c});var o=n(95155),r=n(70112),a=n(81001),s=n(58887),l=n(30578),i=n(7248);let c=e=>{let{title:t,right:n}=e,c=(0,i.h)();return(0,o.jsxs)(r.Group,{className:"app-header",children:[(0,o.jsx)(a.ActionIcon,{variant:"transparent",onClick:c,color:"--text-color",children:(0,o.jsx)(l.I,{name:"back",size:24})}),(0,o.jsx)(s.Text,{lineClamp:2,variant:"gradient",children:t}),n||(0,o.jsx)(a.ActionIcon,{variant:"transparent",color:"--text-color",children:(0,o.jsx)(l.I,{name:"more",size:24})})]})}},99929:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});var o=n(95155),r=n(80630),a=n(69604),s=n(26903),l=n(12115),i=n(89902),c=n(77635),d=n(62741),u=n(6874),m=n.n(u),g=n(6942);n(66810);var h=n(48764);function p(){var e;let t=(0,h.k)(e=>e.wallet),[n,u]=(0,l.useState)(null),[p,w]=(0,l.useState)("mega"),f={mega:{rpc:"https://carrot.megaeth.com/rpc",explorer:"https://www.megaexplorer.xyz",faucet:"https://testnet.megaeth.com/#2",name:"Mega ETH"},monad:{rpc:"https://testnet-rpc.monad.xyz",explorer:"https://testnet.monadexplorer.com",faucet:"https://faucet.monad.xyz",name:"Monad"}};(0,l.useEffect)(()=>{let e=e=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)&&(u(e.key),e.preventDefault())},t=()=>{u(null)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[]);let y=e=>{u(e)},x=()=>{u(null)},[v]=(0,l.useState)(new i.FR(f.mega.rpc)),[j]=(0,l.useState)(new i.FR(f.monad.rpc)),[A,k]=(0,l.useState)(null),[S,M]=(0,l.useState)(null),[b,D]=(0,l.useState)(null),[I,L]=(0,l.useState)(null),N=async e=>{try{let t=await v.getTransactionCount(e);D(t),console.log("".concat(f.mega.name," 网络 nonce:"),t);let n=await j.getTransactionCount(e);L(n),console.log("".concat(f.monad.name," 网络 nonce:"),n)}catch(e){console.error("获取 nonce 失败:",e)}};(0,l.useEffect)(()=>{if(t){let e=c.u.fromPhrase(t.mnemonic);k(e.connect(v)),M(e.connect(j)),N(e.address)}},[t]);let P=async()=>{let e="mega"===p?A:S,t="mega"===p?b:I;if(null!==e&&null!==t)try{"mega"===p?D(t+1):L(t+1);let n=await e.sendTransaction({to:e.address,value:d.g5("0"),nonce:t});console.log("交易哈希:",f[p].explorer+"/tx/"+n.hash),g.notifications.show({color:"green",title:"".concat(f[p].name," 交易哈希"),message:n.hash})}catch(e){console.error("交易失败:",e),g.notifications.show({color:"red",title:"交易失败",message:e.message})}};(0,l.useEffect)(()=>{n&&(console.log("按下按键:",n),g.notifications.show({title:"按下按键",message:n}),P())},[n]);let U=()=>"mega"===p?A:S;return(0,o.jsxs)(a.Box,{id:"page-mega",children:[(0,o.jsx)(r.AppHeader,{title:"".concat(f[p].name," 测试网")}),t?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{style:{marginBottom:"15px"},children:(0,o.jsxs)(s.Button.Group,{children:[(0,o.jsx)(s.Button,{variant:"mega"===p?"filled":"outline",onClick:()=>w("mega"),children:"Mega ETH"}),(0,o.jsx)(s.Button,{variant:"monad"===p?"filled":"outline",onClick:()=>w("monad"),children:"Monad"})]})}),U()&&(0,o.jsxs)("p",{children:[f[p].explorer,"/address/",null==(e=U())?void 0:e.address]}),(0,o.jsx)("p",{children:f[p].rpc}),(0,o.jsx)("p",{children:(0,o.jsxs)(m(),{href:f[p].faucet,target:"_blank",children:[f[p].name," 水龙头"]})}),(0,o.jsxs)("p",{children:["Nonce: ","mega"===p?b:I]}),(0,o.jsx)("div",{className:"keyboard-container",children:(0,o.jsxs)("div",{className:"key-pad",children:[(0,o.jsx)(s.Button,{className:"direction-key up ".concat("ArrowUp"===n?"pressed":""),onMouseDown:()=>y("ArrowUp"),onMouseUp:x,onMouseLeave:x,children:"↑"}),(0,o.jsx)(s.Button,{className:"direction-key left ".concat("ArrowLeft"===n?"pressed":""),onMouseDown:()=>y("ArrowLeft"),onMouseUp:x,onMouseLeave:x,children:"←"}),(0,o.jsx)(s.Button,{className:"direction-key down ".concat("ArrowDown"===n?"pressed":""),onMouseDown:()=>y("ArrowDown"),onMouseUp:x,onMouseLeave:x,children:"↓"}),(0,o.jsx)(s.Button,{className:"direction-key right ".concat("ArrowRight"===n?"pressed":""),onMouseDown:()=>y("ArrowRight"),onMouseUp:x,onMouseLeave:x,children:"→"})]})})]}):(0,o.jsx)(s.Button,{variant:"gradient",component:m(),href:"/login",children:"请先登录"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[1697,8198,9729,5232,5604,6874,9902,6222,578,8441,2721,7358],()=>t(49739)),_N_E=e.O()}]);