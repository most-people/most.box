(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3305],{9534:(e,l,r)=>{"use strict";r.r(l),r.d(l,{default:()=>b});var t=r(95155),n=r(12115),c=r(90101),s=r(67623),i=r(9457),o=r(13877),a=r(2369),d=r(82726),u=r(67661),h=r(17998),f=r(96778),x=r(70305);r(50682);let g=[{dr:-1,dc:0},{dr:1,dc:0},{dr:0,dc:-1},{dr:0,dc:1},{dr:-1,dc:-1},{dr:-1,dc:1},{dr:1,dc:-1},{dr:1,dc:1}];function m(e,l){return e>=0&&e<8&&l>=0&&l<8}function p(){let e=Array.from({length:8},()=>Array.from({length:8},()=>0));return e[3][3]=-1,e[4][4]=-1,e[3][4]=1,e[4][3]=1,e}function j(e,l){let r=[];for(let t=0;t<8;t++)for(let n=0;n<8;n++){let c=function(e,l,r,t){if(0!==e[l][r])return[];let n=[];for(let{dr:c,dc:s}of g){let i=l+c,o=r+s,a=[];for(;m(i,o)&&e[i][o]===-t;)a.push({r:i,c:o}),i+=c,o+=s;a.length>0&&m(i,o)&&e[i][o]===t&&n.push(...a)}return n}(e,t,n,l);c.length>0&&r.push({r:t,c:n,flips:c})}return r}function k(e){return 1===e?"黑":"白"}function B(e){let{value:l,isValid:r,onClick:n,isLastMove:c}=e;return(0,t.jsxs)(s.Box,{onClick:n,className:"othello-cell".concat(r?" is-valid":""),children:[r&&0===l&&(0,t.jsx)(s.Box,{className:"othello-cell__hint"}),0!==l&&(0,t.jsx)(s.Box,{className:"othello-disc ".concat(1===l?"othello-disc--black":"othello-disc--white").concat(c?" is-last":"")})]})}function b(){let[e,l]=(0,n.useState)(()=>p()),[r,g]=(0,n.useState)(1),[m,b]=(0,n.useState)(null),[w,v]=(0,n.useState)(null),[N,C]=(0,n.useState)([]),_=(0,n.useMemo)(()=>j(e,r),[e,r]),y=(0,n.useMemo)(()=>(function(e){let l=0,r=0;for(let t=0;t<8;t++)for(let n=0;n<8;n++)1===e[t][n]&&l++,-1===e[t][n]&&r++;return{black:l,white:r}})(e),[e]),M=(0,n.useMemo)(()=>0===j(e,1).length&&0===j(e,-1).length,[e]);function S(t,n){if(M)return;let c=_.find(e=>e.r===t&&e.c===n);c&&(C(l=>[...l,{board:e,current:r,lastMove:m}]),l(function(e,l,r){let t=e.map(e=>[...e]);for(let e of(t[l.r][l.c]=r,l.flips))t[e.r][e.c]=r;return t}(e,c,r)),b({r:t,c:n}),g(-1*r))}(0,n.useEffect)(()=>{if(!w)return;let e=window.setTimeout(()=>v(null),1200);return()=>window.clearTimeout(e)},[w]),(0,n.useEffect)(()=>{M||0===j(e,r).length&&(C(l=>[...l,{board:e,current:r,lastMove:m}]),v("".concat(k(r),"方无可落子，自动跳过回合")),g(-1*r))},[e,r,M]);let E=(0,n.useMemo)(()=>M?y.black===y.white?"平局":y.black>y.white?"黑方胜":"白方胜":null,[M,y]),G=(0,n.useMemo)(()=>{let l=new Set(_.map(e=>"".concat(e.r,"-").concat(e.c))),r=[];for(let n=0;n<8;n++)for(let c=0;c<8;c++){let o="".concat(n,"-").concat(c),a=e[n][c],d=l.has(o),u=m&&m.r===n&&m.c===c,h=d?"可落子":0===a?null:k(a);r.push((0,t.jsx)(s.Box,{className:"cell-wrapper",children:(0,t.jsx)(i.Tooltip,{label:h,openDelay:200,disabled:!h,children:(0,t.jsx)(s.Box,{onClick:()=>S(n,c),className:"cell-inner",children:(0,t.jsx)(B,{value:a,isValid:d,isLastMove:null!=u?u:void 0,onClick:()=>S(n,c)})})})},o))}return r},[e,_,m]);return(0,t.jsxs)(o.Container,{py:20,id:"page-game-black",children:[(0,t.jsx)(c.AppHeader,{title:"黑白棋（Othello）"}),(0,t.jsxs)(a.Stack,{gap:"md",children:[(0,t.jsxs)(d.Paper,{withBorder:!0,p:"md",radius:"md",children:[(0,t.jsxs)(u.Group,{justify:"space-between",align:"center",children:[(0,t.jsxs)(u.Group,{gap:"xs",align:"center",children:[(0,t.jsxs)(h.Badge,{size:"lg",color:"dark",variant:"filled",children:["黑：",y.black]}),(0,t.jsxs)(h.Badge,{size:"lg",color:"gray",variant:"light",children:["白：",y.white]})]}),(0,t.jsxs)(u.Group,{children:[(0,t.jsx)(f.Button,{onClick:function(){l(p()),g(1),b(null),v(null),C([])},variant:"light",children:"重开"}),(0,t.jsx)(f.Button,{onClick:function(){v(null),C(e=>{if(0===e.length)return e;let r=e[e.length-1];return l(r.board),g(r.current),b(r.lastMove),e.slice(0,-1)})},variant:"outline",disabled:0===N.length,children:"悔棋"})]})]}),(0,t.jsxs)(u.Group,{mt:"sm",gap:"xs",children:[(0,t.jsxs)(h.Badge,{color:1===r?"dark":"gray",variant:"filled",children:["当前回合：",k(r)]}),w&&(0,t.jsx)(h.Badge,{color:"orange",children:w}),M&&(0,t.jsx)(h.Badge,{color:"green",children:E})]})]}),(0,t.jsx)(s.Box,{className:"board-container",children:(0,t.jsx)(s.Box,{className:"board-grid",children:G})}),(0,t.jsx)(d.Paper,{withBorder:!0,p:"md",radius:"md",children:(0,t.jsx)(x.Text,{size:"sm",c:"dimmed",children:"规则：棋子只能落在能吃子的位置。吃子规则为沿直线方向将对方棋子夹在两枚己方棋子之间，夹住的棋子会被翻转为己方颜色。若当前回合无可落子位置，则自动跳过。双方均无可落子位置时，游戏结束，棋子多者获胜。"})})]})]})}},48131:(e,l,r)=>{Promise.resolve().then(r.bind(r,9534))},50682:()=>{}},e=>{e.O(0,[6507,2545,2794,5595,9457,5448,101,8441,1255,7358],()=>e(e.s=48131)),_N_E=e.O()}]);