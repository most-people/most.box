(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4345],{45248:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>J});var n=a(95155),s=a(25107),i=a(2369),r=a(70305),l=a(96778),o=a(13877),c=a(63090),p=a(15239),d=a(20063),u=a(12115),h=a(90101),m=a(12834),y=a(41970),b=a(67661),g=a(74264),x=a(60688),f=a(93852),w=a(9457),j=a(58380),T=a(73524),v=a(82726),M=a(52619),k=a.n(M),D=a(13297),A=a(67812),C=a(26195),I=a(29722);let S=()=>{let e=(0,d.usePathname)(),t=(0,d.useSearchParams)(),a=t.get("type")||"file",s=e.split("/")[2]||"",o=t.get("filename")||"",[c,p]=(0,u.useState)(o),M=(0,D.k)(e=>e.dotCID),S=(0,D.k)(e=>e.dotAPI),_=(0,u.useMemo)(()=>{if(S&&s){let e=new URL(location.origin);e.pathname="/ipfs/".concat(s),c&&(e.searchParams.set("filename",c),e.searchParams.set("type",a));try{e.hash=new URL(S).host}catch(e){}return e.href}return""},[S,s,c]),P=(0,u.useMemo)(()=>{if(M&&s){let e=new URL(M);return e.pathname="/ipfs/".concat(s),c&&e.searchParams.set("filename",c),e.href}return""},[M,s,c]),B=(0,u.useMemo)(()=>{if(M&&s){let e=new URL(M);return e.pathname="/ipfs/".concat(s),e.searchParams.set("download","true"),c&&("dir"===a||"note"===a?(e.searchParams.set("format","tar"),e.searchParams.set("filename","".concat(c,".tar"))):e.searchParams.set("filename",c)),e.href}return""},[M,s,c,a]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.AppHeader,{title:c||s||"CID"}),(0,n.jsxs)(i.Stack,{gap:"lg",children:[!s&&(0,n.jsx)(y.Alert,{icon:(0,n.jsx)(A.A,{size:18}),color:"orange",radius:"md",children:"未提供 CID，请通过带有 cid 的链接访问本页。"}),(0,n.jsxs)(b.Group,{justify:"space-between",align:"center",children:[(0,n.jsxs)(b.Group,{gap:8,children:["dir"===a?"\uD83D\uDCC1":"\uD83D\uDCC4",(0,n.jsxs)(g.Title,{order:4,children:["dir"===a?"文件夹":"文件","信息"]})]}),o&&(0,n.jsx)(r.Text,{size:"sm",c:"dimmed",children:o})]}),(0,n.jsxs)(i.Stack,{children:[(0,n.jsx)(x.TextInput,{radius:"md",label:"CID",placeholder:"请输入 CID",value:s,readOnly:!0,variant:"filled"}),(0,n.jsx)(x.TextInput,{radius:"md",label:"dir"===a?"文件夹":"文件名",placeholder:"dir"===a?"文件夹":"文件名",value:c,onChange:e=>p(e.currentTarget.value)})]}),(0,n.jsx)(b.Group,{justify:"space-between",children:(0,n.jsxs)(b.Group,{gap:8,children:["\uD83D\uDCD6",(0,n.jsx)(g.Title,{order:4,children:"查看 / 下载"})]})}),!M&&(0,n.jsx)(y.Alert,{color:"gray",radius:"md",mb:"sm",children:"未连接到 Dot 节点，下载链接将不可用。"}),(0,n.jsx)(x.TextInput,{radius:"md",value:P||"",readOnly:!0,variant:"filled",disabled:!P,placeholder:"无可用链接",rightSection:(0,n.jsx)(f.CopyButton,{value:P||"",children:e=>{let{copied:t,copy:a}=e;return(0,n.jsx)(w.Tooltip,{label:t?"已复制":"复制链接",position:"top",children:(0,n.jsx)(j.ActionIcon,{variant:"subtle",color:t?"teal":"gray",onClick:a,disabled:!P,children:(0,n.jsx)(C.A,{size:16})})})}})}),(0,n.jsxs)(b.Group,{wrap:"nowrap",children:[(0,n.jsx)(l.Button,{color:"green",variant:"light",w:"100%",component:k(),target:"_blank",href:P,children:"查看"}),c?(0,n.jsx)(l.Button,{variant:"light",color:"blue",w:"100%",component:k(),target:"_blank",href:B,children:"下载"}):(0,n.jsx)(l.Button,{variant:"light",color:"blue",w:"100%",disabled:!0,children:"下载"})]}),"note"===a&&(0,n.jsx)(l.Button,{variant:"light",w:"100%",component:k(),href:"/note/?cid=".concat(s,"&name=").concat(c),target:"_blank",children:"打开笔记"}),(0,n.jsx)(b.Group,{justify:"space-between",children:(0,n.jsxs)(b.Group,{gap:8,children:["\uD83D\uDCE4",(0,n.jsx)(g.Title,{order:4,children:"分享本页"})]})}),!S&&(0,n.jsx)(y.Alert,{color:"gray",radius:"md",mb:"sm",children:"未设置 Dot API，分享链接将不可用。"}),(0,n.jsx)(x.TextInput,{radius:"md",value:_||"",readOnly:!0,variant:"filled",disabled:!_,placeholder:"无可用链接",rightSection:(0,n.jsx)(f.CopyButton,{value:_||"",children:e=>{let{copied:t,copy:a}=e;return(0,n.jsx)(w.Tooltip,{label:t?"已复制":"复制链接",position:"top",children:(0,n.jsx)(j.ActionIcon,{variant:"subtle",color:t?"teal":"gray",onClick:a,disabled:!_,children:(0,n.jsx)(C.A,{size:16})})})}})}),_&&(0,n.jsx)(T.Flex,{justify:"center",children:(0,n.jsx)(v.Paper,{radius:"md",p:12,withBorder:!0,style:{backgroundColor:"white"},children:(0,n.jsxs)(i.Stack,{gap:9,children:[(0,n.jsxs)(b.Group,{justify:"center",gap:6,children:[(0,n.jsx)(I.A,{size:18}),(0,n.jsx)(r.Text,{size:"sm",c:"dimmed",children:"扫码分享"}),(0,n.jsx)(I.A,{size:18})]}),(0,n.jsx)(m.h,{value:_,size:200,bgColor:"white",fgColor:"#333",level:"M"})]})})})]})]})};function _(){return(0,n.jsx)(u.Suspense,{children:(0,n.jsx)(S,{})})}var P=a(53987),B=a(33864),N=a(67623),E=a(81216),z=a(41524),G=a(54827),L=a(97443),O=a(21794),R=a(61505),H=a(99682),U=a(59126);function W(){let e=(0,d.usePathname)(),[t,a]=(0,u.useState)(""),s=P.WC.mainnet.rpc,[l,o]=(0,u.useState)(""),c=(0,u.useMemo)(()=>new E.FR(s),[s]),p=(0,u.useMemo)(()=>new z.NZ(P.i5,P.yc,c),[c]),[m,y]=(0,u.useState)(""),[b,g]=(0,u.useState)("");(0,u.useEffect)(()=>{a(e.split("/")[1].slice(1))},[e]);let x=async e=>{try{let t=await p.getOwner(e);y(t),f(t)}catch(e){console.warn("获取地址失败",e),U.notifications.show({message:"获取地址失败",color:"red"})}},f=async e=>{try{let t=await p.getName(e);t?w(t):U.notifications.show({message:"没有绑定用户名"})}catch(e){console.warn("获取用户名失败",e)}},w=t=>{g(t);let a=e.split("/");a[1]="@"+t;let n=new URL(window.location.href);n.pathname=a.join("/"),window.history.replaceState(null,"",n.href)};(0,u.useEffect)(()=>{t&&((0,G.PW)(t)?(y(t),f(t)):(x(t),g(t)))},[t]);let T=(0,D.k)(e=>e.nodeDark),v=(0,D.k)(e=>e.dotAPI),M=(0,D.k)(e=>e.updateDot),A=(0,u.useRef)(null),C=(0,R.B)(),I=e.split("/")[2]||".profile",[S,_]=(0,u.useState)(""),W=async(e,t,a)=>{v||M(t);try{let n=(await O.FH.get("/files.cid/".concat(e,"/.note/").concat(I),{baseURL:t})).data;if(n){_(n);let e=await fetch("".concat(a,"/ipfs/").concat(n,"/index.md")),t=await e.text();t&&A.current&&(await C.initViewer(A.current)).setMarkdown(t)}else throw Error("cid 不存在")}catch(e){console.warn("获取笔记失败",e),U.notifications.show({message:"获取笔记 ".concat(I," 失败"),color:"red"})}},F=async e=>{try{let t=await p.getData(e);if(t){let a=JSON.parse(t);if(null==a?void 0:a.dot){o(a.dot);let t=(await O.FH.get("/api.dot",{baseURL:a.dot})).data;if(t){let n=t.CIDs[0];v.endsWith(":1976")&&(n=v.slice(0,-5)+":8080"),W(e,a.dot,n)}else throw Error("获取 api.dot 失败")}else throw Error("获取 data.dot 失败")}else throw Error("获取 data 失败")}catch(e){console.warn("获取数据失败",e),U.notifications.show({message:"获取数据失败",color:"red"})}};return(0,u.useEffect)(()=>{m&&F(m)},[m]),(0,n.jsxs)(i.Stack,{children:[(0,n.jsx)(h.AppHeader,{title:b||L.A.formatAddress(m),right:(0,n.jsxs)(B.Menu,{shadow:"md",children:[(0,n.jsx)(B.Menu.Target,{children:(0,n.jsx)(j.ActionIcon,{variant:"transparent",color:"--text-color",children:(0,n.jsx)(H.I,{name:"More",size:24})})}),(0,n.jsx)(B.Menu.Dropdown,{children:(0,n.jsx)(B.Menu.Item,{leftSection:"✏️",component:k(),href:"/note/?uid=".concat(m,"&name=").concat(I,"&cid=").concat(S),target:"_blank",children:"编辑"})})]})}),(0,n.jsxs)(r.Text,{children:["用户名：",b]}),(0,n.jsxs)(r.Text,{children:["地址：",m]}),(0,n.jsxs)(r.Text,{children:["节点：",l]}),(0,n.jsxs)(r.Text,{children:["CID：",S]}),(0,n.jsx)(N.Box,{className:T,ref:A})]})}let F=()=>{let e=(0,s.h)();return(0,n.jsxs)(i.Stack,{gap:"md",align:"center",children:[(0,n.jsx)(p.default,{src:"/img/404.svg",alt:"404",width:300,height:225}),(0,n.jsx)(r.Text,{c:"dimmed",children:"抱歉，你要找的页面不见了"}),(0,n.jsx)(l.Button,{onClick:e,variant:"gradient",children:"返回首页"})]})};function J(){let e=(0,d.usePathname)(),[t,a]=(0,u.useState)("");return(0,u.useEffect)(()=>{e.startsWith("/ipfs/")?a("ipfs"):e.startsWith("/@")?e.slice(2,-1)&&a("website"):a("404")},[e]),(0,n.jsx)(o.Container,{w:"100%",p:"md",children:""===t?(0,n.jsx)(i.Stack,{align:"center",children:(0,n.jsx)(c.Loader,{color:"black",size:"lg",type:"bars"})}):"website"===t?(0,n.jsx)(W,{}):"ipfs"===t?(0,n.jsx)(_,{}):(0,n.jsx)(F,{})})}},53987:(e,t,a)=>{"use strict";a.d(t,{Wf:()=>c,yc:()=>p,MT:()=>i,i5:()=>r,WC:()=>o,Pt:()=>l});let n=JSON.parse('[{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"Data","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MAX_DATA_LENGTH","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MAX_NAME_LENGTH","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MIN_NAME_LENGTH","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"deleteData","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"deleteName","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_address","type":"address"}],"name":"getData","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_address","type":"address"}],"name":"getName","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_name","type":"string"}],"name":"getOwner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"","type":"string"}],"name":"nameOwners","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"names","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_data","type":"string"}],"name":"setData","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"_newName","type":"string"}],"name":"setName","outputs":[],"stateMutability":"nonpayable","type":"function"}]'),s=["https://base.llamarpc.com","https://mainnet.base.org","https://developer-access-mainnet.base.org","https://base-mainnet.diamondswap.org/rpc","https://base.public.blockpi.network/v1/rpc/public","https://1rpc.io/base","https://base-pokt.nodies.app","https://base.meowrpc.com","https://base-mainnet.public.blastapi.io","https://base.gateway.tenderly.co","https://gateway.tenderly.co/public/base","https://rpc.notadegen.com/base","https://base-rpc.publicnode.com","https://base.drpc.org","https://base.api.onfinality.io/public","https://public.stackup.sh/api/v1/node/base-mainnet","https://base-mainnet.gateway.tatum.io","https://base.rpc.subquery.network/public","https://api.zan.top/base-mainnet","https://endpoints.omniatech.io/v1/base/mainnet/public","https://base.lava.build","https://rpc.numa.network/base","https://node.histori.xyz/base-mainnet/8ry9f6t9dct1se2hlagxnd9n2a","https://0xrpc.io/base","https://rpc.owlracle.info/base/70d38ce1826c4a60bb2a8e05a6c8b20f","https://base.therpc.io"],i="0xB67662F0d2BB106B055503062e1dba4f072f5781",r="0x1bcB1bD1c669e154c1d69D7c7C2Ab5D19C9109DB",l=()=>s[Math.floor(Math.random()*s.length)],o={mainnet:{chainId:8453,rpc:"https://mainnet.base.org",name:"Base 主网",color:"blue",explorer:"https://basescan.org"},testnet:{chainId:84532,rpc:"https://sepolia.base.org",name:"Base 测试网",color:"orange",explorer:"https://sepolia.basescan.org"}},c=[{inputs:[],name:"getAllDots",outputs:[{internalType:"address[]",name:"addresses",type:"address[]"},{internalType:"string[]",name:"names",type:"string[]"},{internalType:"string[][]",name:"APIss",type:"string[][]"},{internalType:"string[][]",name:"CIDss",type:"string[][]"},{internalType:"uint256[]",name:"updates",type:"uint256[]"}],stateMutability:"view",type:"function"}],p=n},99415:(e,t,a)=>{Promise.resolve().then(a.bind(a,45248))}},e=>{e.O(0,[8198,2545,642,2829,5619,6714,8555,8990,5125,9287,9318,3252,9457,8835,3843,3864,2834,7141,101,8289,8441,1255,7358],()=>e(e.s=99415)),_N_E=e.O()}]);